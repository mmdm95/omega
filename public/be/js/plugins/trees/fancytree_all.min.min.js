/*! jQuery Fancytree Plugin - 2.18.0 - 2016-05-02T19:34
  * https://github.com/mar10/fancytree
  * Copyright (c) 2016 Martin Wendt; Licensed MIT */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){!function(ar,aq,ap,ao){function an(d,e){d||(e=e?": "+e:"",ar.error("Fancytree assertion failed"+e))}function am(b,l){var k,j,i=aq.console?aq.console[b]:null;if(i){try{i.apply(aq.console,l)}catch(h){for(j="",k=0;k<l.length;k++){j+=l[k]}i(j)}}}function al(b){return !(!b.tree||b.statusNodeType===ao)}function ak(s,r,q,p){var o,n,m,l=ar.map(ar.trim(s).split("."),function(b){return parseInt(b,10)}),k=ar.map(Array.prototype.slice.call(arguments,1),function(b){return parseInt(b,10)});for(o=0;o<k.length;o++){if(n=l[o]||0,m=k[o]||0,n!==m){return n>m}}return !0}function aj(h,g,l,k,j){var i=function(){var n=g[h],m=k[h],e=g.ext[j],d=function(){return n.apply(g,arguments)},b=function(c){return n.apply(g,c)};return function(){var f=g._local,p=g._super,o=g._superApply;try{return g._local=e,g._super=d,g._superApply=b,m.apply(g,arguments)}finally{g._local=f,g._super=p,g._superApply=o}}}();return i}function ai(g,k,j,i){for(var h in j){"function"==typeof j[h]?"function"==typeof g[h]?g[h]=aj(h,g,k,j,i):"_"===h.charAt(0)?g.ext[i][h]=aj(h,g,k,j,i):ar.error("Could not override tree."+h+". Use prefix '_' to create tree."+i+"._"+h):"options"!==h&&(g.ext[i][h]=j[h])}}function ah(d,e){return d===ao?ar.Deferred(function(){this.resolve()}).promise():ar.Deferred(function(){this.resolveWith(d,e)}).promise()}function ag(d,e){return d===ao?ar.Deferred(function(){this.reject()}).promise():ar.Deferred(function(){this.rejectWith(d,e)}).promise()}function af(d,c){return function(){d.resolveWith(c)}}function ae(e){var g=ar.extend({},e.data()),f=g.json;return delete g.fancytree,delete g.uiFancytree,f&&(delete g.json,g=ar.extend(g,f)),g}function ad(b){return(""+b).replace(M,function(c){return J[c]})}function ac(b){return b=b.toLowerCase(),function(c){return c.title.toLowerCase().indexOf(b)>=0}}function aa(d){var c=new RegExp("^"+d,"i");return function(b){return c.test(b.title)}}function Y(e,m){var l,k,j,i;for(this.parent=e,this.tree=e.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},l=0,k=R.length;k>l;l++){j=R[l],this[j]=m[j]}m.data&&ar.extend(this.data,m.data);for(j in m){P[j]||ar.isFunction(m[j])||L[j]||(this.data[j]=m[j])}null==this.key?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),an(this.key,"defaultKey() must return a unique key")):this.key="_"+Q._nextNodeKey++:this.key=""+this.key,m.active&&(an(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),m.selected&&(this.tree.lastSelectedNode=this),i=m.children,i?i.length?this._setChildren(i):this.children=this.lazy?[]:null:this.children=null,this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function W(d){this.widget=d,this.$div=d.element,this.options=d.options,this.options&&(ar.isFunction(this.options.lazyload)&&!ar.isFunction(this.options.lazyLoad)&&(this.options.lazyLoad=function(){return Q.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),d.options.lazyload.apply(this,arguments)}),ar.isFunction(this.options.loaderror)&&ar.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),this.options.fx!==ao&&Q.warn("The 'fx' options was replaced by 'toggleEffect' since 2014-11-30.")),this.ext={},this.data=ae(this.$div),this._id=ar.ui.fancytree._nextId++,this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this.lastSelectedNode=null,this.systemFocusElement=null,this.lastQuicksearchTerm="",this.lastQuicksearchTime=0,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove();var g,f={tree:this};this.rootNode=new Y(f,{title:"root",key:"root_"+this._id,children:null,expanded:!0}),this.rootNode.parent=null,g=ar("<ul>",{"class":"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div),this.$container=g,this.rootNode.ul=g[0],null==this.options.debugLevel&&(this.options.debugLevel=Q.debugLevel),this.$container.attr("tabindex",this.options.tabindex),this.options.aria&&this.$container.attr("role","tree").attr("aria-multiselectable",!0)}if(ar.ui&&ar.ui.fancytree){return void ar.ui.fancytree.warn("Fancytree: ignored duplicate include")}var U,S,Q=null,O=new RegExp(/\.|\//),M=/[&<>"'\/]/g,K="$recursive_request",J={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ab={16:!0,17:!0,18:!0},Z={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},X={0:"",1:"left",2:"middle",3:"right"},V="active expanded focus folder hideCheckbox lazy selected unselectable".split(" "),T={},R="expanded extraClasses folder hideCheckbox icon key lazy refKey selected statusNodeType title tooltip unselectable".split(" "),P={},N={},L={active:!0,children:!0,data:!0,focus:!0};for(U=0;U<V.length;U++){T[V[U]]=!0}for(U=0;U<R.length;U++){S=R[U],P[S]=!0,S!==S.toLowerCase()&&(N[S.toLowerCase()]=S)}an(ar.ui,"Fancytree requires jQuery UI (http://jqueryui.com)"),Y.prototype={_findDirectChild:function(f){var e,h,g=this.children;if(g){if("string"==typeof f){for(e=0,h=g.length;h>e;e++){if(g[e].key===f){return g[e]}}}else{if("number"==typeof f){return this.children[f]}if(f.parent===this){return f}}}return null},_setChildren:function(e){an(e&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var d=0,f=e.length;f>d;d++){this.children.push(new Y(this,e[d]))}},addChildren:function(e,o){var n,m,l,k=null,j=[];for(ar.isPlainObject(e)&&(e=[e]),this.children||(this.children=[]),n=0,m=e.length;m>n;n++){j.push(new Y(this,e[n]))}return k=j[0],null==o?this.children=this.children.concat(j):(o=this._findDirectChild(o),l=ar.inArray(o,this.children),an(l>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[l,0].concat(j))),(!this.parent||this.parent.ul||this.tr)&&this.render(),3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),k},addClass:function(b){return this.toggleClass(b,!0)},addNode:function(e,d){switch(d!==ao&&"over"!==d||(d="child"),d){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"firstChild":var f=this.children?this.children[0]:null;return this.addChildren(e,f);case"child":case"over":return this.addChildren(e)}an(!1,"Invalid mode: "+d)},addPagingNode:function(f,i){var h,g;if(i=i||"child",f===!1){for(h=this.children.length-1;h>=0;h--){g=this.children[h],"paging"===g.statusNodeType&&this.removeChild(g)}return void (this.partload=!1)}return f=ar.extend({title:this.tree.options.strings.moreData,statusNodeType:"paging",icon:!1},f),this.partload=!0,this.addNode(f,i)},appendSibling:function(b){return this.addNode(b,"after")},applyPatch:function(g){if(null===g){return this.remove(),ah(this)}var k,j,i,h={children:!0,expanded:!0,parent:!0};for(k in g){i=g[k],h[k]||ar.isFunction(i)||(P[k]?this[k]=i:this.data[k]=i)}return g.hasOwnProperty("children")&&(this.removeChildren(),g.children&&this._setChildren(g.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),j=g.hasOwnProperty("expanded")?this.setExpanded(g.expanded):ah(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(e,d,f){return e.addNode(this.toDict(!0,f),d)},countChildren:function(g){var f,j,i,h=this.children;if(!h){return 0}if(i=h.length,g!==!1){for(f=0,j=i;j>f;f++){i+=h[f].countChildren()}}return i},debug:function(b){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),am("log",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},discardMarkup:function(d){var c=d?"nodeRemoveMarkup":"nodeRemoveChildMarkup";this.tree._callHook(c,this)},findAll:function(d){d=ar.isFunction(d)?d:ac(d);var e=[];return this.visit(function(b){d(b)&&e.push(b)}),e},findFirst:function(d){d=ar.isFunction(d)?d:ac(d);var e=null;return this.visit(function(b){return d(b)?(e=b,!1):void 0}),e},_changeSelectStatusAttrs:function(d){var c=!1;switch(d){case !1:c=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case !0:c=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case ao:c=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:an(!1,"invalid state: "+d)}return c&&this.renderStatus(),c},fixSelection3AfterClick:function(){var b=this.isSelected();this.visit(function(c){c._changeSelectStatusAttrs(b)}),this.fixSelection3FromEndNodes()},fixSelection3FromEndNodes:function(){function b(s){var r,q,p,o,n,m,l,d=s.children;if(d&&d.length){for(m=!0,l=!1,r=0,q=d.length;q>r;r++){p=d[r],o=b(p),o!==!1&&(l=!0),o!==!0&&(m=!1)}n=m?!0:l?ao:!1}else{n=!!s.selected}return s._changeSelectStatusAttrs(n),n}an(3===this.tree.options.selectMode,"expected selectMode 3"),b(this),this.visitParents(function(j){var d,p,o,n,m=j.children,l=!0,k=!1;for(d=0,p=m.length;p>d;d++){o=m[d],(o.selected||o.partsel)&&(k=!0),o.unselectable||o.selected||(l=!1)}n=l?!0:k?ao:!1,j._changeSelectStatusAttrs(n)})},fromDict:function(d){for(var e in d){P[e]?this[e]=d[e]:"data"===e?ar.extend(this.data,d.data):ar.isFunction(d[e])||L[e]||(this.data[e]=d[e])}d.children&&(this.removeChildren(),this.addChildren(d.children)),this.renderTitle()},getChildren:function(){return this.hasChildren()===ao?ao:this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return ar.inArray(this,this.parent.children)},getIndexHier:function(f,i){f=f||".";var h,g=[];return ar.each(this.getParentList(!1,!0),function(d,c){h=""+(c.getIndex()+1),i&&(h=("0000000"+h).substr(-i)),g.push(h)}),g.join(f)},getKeyPath:function(e){var d=[],f=this.tree.options.keyPathSeparator;return this.visitParents(function(b){b.parent&&d.unshift(b.key)},!e),f+d.join(f)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var d=0,c=this.parent;c;){d++,c=c.parent}return d},getNextSibling:function(){if(this.parent){var e,d,f=this.parent.children;for(e=0,d=f.length-1;d>e;e++){if(f[e]===this){return f[e+1]}}}return null},getParent:function(){return this.parent},getParentList:function(f,e){for(var h=[],g=e?this:this.parent;g;){(f||g.parent)&&h.unshift(g),g=g.parent}return h},getPrevSibling:function(){if(this.parent){var e,d,f=this.parent.children;for(e=1,d=f.length;d>e;e++){if(f[e]===this){return f[e-1]}}}return null},getSelectedNodes:function(d){var c=[];return this.visit(function(b){return b.selected&&(c.push(b),d===!0)?"skip":void 0}),c},hasChildren:function(){return this.lazy?null==this.children?ao:0===this.children.length?!1:1===this.children.length&&this.children[0].isStatusNode()?ao:!0:!(!this.children||!this.children.length)},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(b){this.tree.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),am("info",arguments))},isActive:function(){return this.tree.activeNode===this},isChildOf:function(b){return this.parent&&this.parent===b},isDescendantOf:function(d){if(!d||d.tree!==this.tree){return !1}for(var c=this.parent;c;){if(c===d){return !0}c=c.parent}return !1},isExpanded:function(){return !!this.expanded},isFirstSibling:function(){var b=this.parent;return !b||b.children[0]===this},isFolder:function(){return !!this.folder},isLastSibling:function(){var b=this.parent;return !b||b.children[b.children.length-1]===this},isLazy:function(){return !!this.lazy},isLoaded:function(){return !this.lazy||this.hasChildren()!==ao},isLoading:function(){return !!this._isLoading},isRoot:function(){return this.isRootNode()},isPartload:function(){return !!this.partload},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return !!this.selected},isStatusNode:function(){return !!this.statusNodeType},isPagingNode:function(){return"paging"===this.statusNodeType},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return this.hasChildren()===ao},isVisible:function(){var e,d,f=this.getParentList(!1,!1);for(e=0,d=f.length;d>e;e++){if(!f[e].expanded){return !1}}return !0},lazyLoad:function(b){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(b)},load:function(f){var e,h,g=this;return an(this.isLazy(),"load() requires a lazy node"),f||this.isUndefined()?(this.isLoaded()&&this.resetLazy(),h=this.tree._triggerNodeEvent("lazyLoad",this),h===!1?ah(this):(an("boolean"!=typeof h,"lazyLoad event must return source in data.result"),e=this.tree._callHook("nodeLoadChildren",this,h),this.expanded&&e.always(function(){g.render()}),e)):ah(this)},makeVisible:function(s){var r,q=this,p=[],o=new ar.Deferred,n=this.getParentList(!1,!1),m=n.length,l=!(s&&s.noAnimation===!0),k=!(s&&s.scrollIntoView===!1);for(r=m-1;r>=0;r--){p.push(n[r].setExpanded(!0,s))}return ar.when.apply(ar,p).done(function(){k?q.scrollIntoView(l).done(function(){o.resolve()}):o.resolve()}),o.promise()},moveTo:function(d,m,l){m===ao||"over"===m?m="child":"firstChild"===m&&(d.children&&d.children.length?(m="before",d=d.children[0]):m="child");var k,j=this.parent,e="child"===m?d:d.parent;if(this!==d){if(this.parent?e.isDescendantOf(this)&&ar.error("Cannot move a node to its own descendant"):ar.error("Cannot move system root"),1===this.parent.children.length){if(this.parent===e){return}this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else{k=ar.inArray(this,this.parent.children),an(k>=0,"invalid source parent"),this.parent.children.splice(k,1)}if(this.parent=e,e.hasChildren()){switch(m){case"child":e.children.push(this);break;case"before":k=ar.inArray(d,e.children),an(k>=0,"invalid target parent"),e.children.splice(k,0,this);break;case"after":k=ar.inArray(d,e.children),an(k>=0,"invalid target parent"),e.children.splice(k+1,0,this);break;default:ar.error("Invalid mode "+m)}}else{e.children=[this]}l&&d.visit(l,!0),this.tree!==d.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit(function(b){b.tree=d.tree},!0)),j.isDescendantOf(e)||j.render(),e.isDescendantOf(j)||e===j||e.render()}},navigate:function(s,r){function q(c){if(c){try{c.makeVisible()}catch(b){}return ar(c.span).is(":visible")?r===!1?c.setFocus():c.setActive():(c.debug("Navigate: skipping hidden node"),void c.navigate(s,r))}}var p,o,n,m=!0,l=ar.ui.keyCode,k=null;switch(s){case l.BACKSPACE:this.parent&&this.parent.parent&&(n=q(this.parent));break;case l.LEFT:this.expanded?(this.setExpanded(!1),n=q(this)):this.parent&&this.parent.parent&&(n=q(this.parent));break;case l.RIGHT:this.expanded||!this.children&&!this.lazy?this.children&&this.children.length&&(n=q(this.children[0])):(this.setExpanded(),n=q(this));break;case l.UP:for(k=this.getPrevSibling();k&&!ar(k.span).is(":visible");){k=k.getPrevSibling()}for(;k&&k.expanded&&k.children&&k.children.length;){k=k.children[k.children.length-1]}!k&&this.parent&&this.parent.parent&&(k=this.parent),n=q(k);break;case l.DOWN:if(this.expanded&&this.children&&this.children.length){k=this.children[0]}else{for(o=this.getParentList(!1,!0),p=o.length-1;p>=0;p--){for(k=o[p].getNextSibling();k&&!ar(k.span).is(":visible");){k=k.getNextSibling()}if(k){break}}}n=q(k);break;default:m=!1}return n||ah()},remove:function(){return this.parent.removeChild(this)},removeChild:function(b){return this.tree._callHook("nodeRemoveChild",this,b)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},removeClass:function(b){return this.toggleClass(b,!1)},render:function(d,c){return this.tree._callHook("nodeRender",this,d,c)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},replaceWith:function(e){var k,j=this.parent,i=ar.inArray(this,j.children),h=this;return an(this.isPagingNode(),"replaceWith() currently requires a paging status node"),k=this.tree._callHook("nodeLoadChildren",this,e),k.done(function(d){var c=h.children;for(U=0;U<c.length;U++){c[U].parent=j}j.children.splice.apply(j.children,[i+1,0].concat(c)),h.children=null,h.remove(),j.render()}).fail(function(){h.setExpanded()}),k},resetLazy:function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=ao,this.renderStatus()},scheduleAction:function(e,g){this.tree.timer&&clearTimeout(this.tree.timer),this.tree.timer=null;var f=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){f.tree.debug("setTimeout: trigger expand"),f.setExpanded(!0)},g);break;case"activate":this.tree.timer=setTimeout(function(){f.tree.debug("setTimeout: trigger activate"),f.setActive(!0)},g);break;default:ar.error("Invalid mode "+e)}},scrollIntoView:function(aw,av){av!==ao&&al(av)&&(this.warn("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead."),av={topNode:av});var au,at,I,H,G=ar.extend({effects:aw===!0?{duration:200,queue:!1}:aw,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent||this.tree.$container,topNode:null},av),F=new ar.Deferred,E=this,D=ar(this.span).height(),C=ar(G.scrollParent),B=G.scrollOfs.top||0,A=G.scrollOfs.bottom||0,k=C.height(),g=C.scrollTop(),e=C,d=C[0]===aq,c=G.topNode||null,b=null;return ar(this.span).is(":visible")?(d?(at=ar(this.span).offset().top,au=c&&c.span?ar(c.span).offset().top:0,e=ar("html,body")):(an(C[0]!==ap&&C[0]!==ap.body,"scrollParent should be a simple element or `window`, not document or body."),H=C.offset().top,at=ar(this.span).offset().top-H+g,au=c?ar(c.span).offset().top-H+g:0,I=Math.max(0,C.innerHeight()-C[0].clientHeight),k-=I),g+B>at?b=at-B:at+D>g+k-A&&(b=at+D-k+A,c&&(an(c.isRootNode()||ar(c.span).is(":visible"),"topNode must be visible"),b>au&&(b=au-B))),null!==b?G.effects?(G.effects.complete=function(){F.resolveWith(E)},e.stop(!0).animate({scrollTop:b},G.effects)):(e[0].scrollTop=b,F.resolveWith(this)):F.resolveWith(this),F.promise()):(this.warn("scrollIntoView(): node is invisible."),ah())},setActive:function(d,c){return this.tree._callHook("nodeSetActive",this,d,c)},setExpanded:function(d,c){return this.tree._callHook("nodeSetExpanded",this,d,c)},setFocus:function(b){return this.tree._callHook("nodeSetFocus",this,b)},setSelected:function(b){return this.tree._callHook("nodeSetSelected",this,b)},setStatus:function(e,d,f){return this.tree._callHook("nodeSetStatus",this,e,d,f)},setTitle:function(b){this.title=b,this.renderTitle()},sortChildren:function(g,f){var j,i,h=this.children;if(h){if(g=g||function(k,e){var m=k.title.toLowerCase(),l=e.title.toLowerCase();return m===l?0:m>l?1:-1},h.sort(g),f){for(j=0,i=h.length;i>j;j++){h[j].children&&h[j].sortChildren(g,"$norender$")}}"$norender$"!==f&&this.render()}},toDict:function(i,o){var n,m,l,k={},j=this;if(ar.each(R,function(d,c){(j[c]||j[c]===!1)&&(k[c]=j[c])}),ar.isEmptyObject(this.data)||(k.data=ar.extend({},this.data),ar.isEmptyObject(k.data)&&delete k.data),o&&o(k,j),i&&this.hasChildren()){for(k.children=[],n=0,m=this.children.length;m>n;n++){l=this.children[n],l.isStatusNode()||k.children.push(l.toDict(!0,o))}}return k},toggleClass:function(u,t){var s,r,q=/\S+/g,p=u.match(q)||[],o=0,n=!1,m=this[this.tree.statusClassPropName],d=" "+(this.extraClasses||"")+" ";for(m&&ar(m).toggleClass(u,t);s=p[o++];){if(r=d.indexOf(" "+s+" ")>=0,t=t===ao?!r:!!t){r||(d+=s+" ",n=!0)}else{for(;d.indexOf(" "+s+" ")>-1;){d=d.replace(" "+s+" "," ")}}}return this.extraClasses=ar.trim(d),n},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"<FancytreeNode(#"+this.key+", '"+this.title+"')>"},visit:function(h,g){var l,k,j=!0,i=this.children;if(g===!0&&(j=h(this),j===!1||"skip"===j)){return j}if(i){for(l=0,k=i.length;k>l&&(j=i[l].visit(h,!0),j!==!1);l++){}}return j},visitAndLoad:function(i,o,n){var m,l,k,j=this;return i&&o===!0&&(l=i(j),l===!1||"skip"===l)?n?l:ah():j.children||j.lazy?(m=new ar.Deferred,k=[],j.load().done(function(){for(var e=0,b=j.children.length;b>e;e++){if(l=j.children[e].visitAndLoad(i,!0,!0),l===!1){m.reject();break}"skip"!==l&&k.push(l)}ar.when.apply(this,k).then(function(){m.resolve()})}),m.promise()):ah()},visitParents:function(e,d){if(d&&e(this)===!1){return !1}for(var f=this.parent;f;){if(e(f)===!1){return !1}f=f.parent}return !0},warn:function(b){Array.prototype.unshift.call(arguments,this.toString()),am("warn",arguments)}},W.prototype={_makeHookContext:function(d,k,j){var i,h;return d.node!==ao?(k&&d.originalEvent!==k&&ar.error("invalid args"),i=d):d.tree?(h=d.tree,i={node:d,tree:h,widget:h.widget,options:h.widget.options,originalEvent:k}):d.widget?i={node:null,tree:d,widget:d.widget,options:d.widget.options,originalEvent:k}:ar.error("invalid args"),j&&ar.extend(i,j),i},_callHook:function(h,m,l){var k=this._makeHookContext(m),j=this[h],i=Array.prototype.slice.call(arguments,2);return ar.isFunction(j)||ar.error("_callHook('"+h+"') is not a function"),i.unshift(k),j.apply(this,i)},_requireExtension:function(s,r,q,p){q=!!q;var o=this._local.name,n=this.options.extensions,m=ar.inArray(s,n)<ar.inArray(o,n),l=r&&null==this.ext[s],e=!l&&null!=q&&q!==m;return an(o&&o!==s,"invalid or same name"),l||e?(p||(l||r?(p="'"+o+"' extension requires '"+s+"'",e&&(p+=" to be registered "+(q?"before":"after")+" itself")):p="If used together, `"+s+"` must be registered "+(q?"before":"after")+" `"+o+"`"),ar.error(p),!1):!0},activateKey:function(d){var c=this.getNodeByKey(d);return c?c.setActive():this.activeNode&&this.activeNode.setActive(!1),c},addPagingNode:function(d,c){return this.rootNode.addPagingNode(d,c)},applyPatch:function(s){var r,q,p,o,n,m,l=s.length,e=[];for(q=0;l>q;q++){p=s[q],an(2===p.length,"patchList must be an array of length-2-arrays"),o=p[0],n=p[1],m=null===o?this.rootNode:this.getNodeByKey(o),m?(r=new ar.Deferred,e.push(r),m.applyPatch(n).always(af(r,m))):this.warn("could not find node with key '"+o+"'")}return ar.when.apply(ar,e).promise()},clear:function(b){this._callHook("treeClear",this)},count:function(){return this.rootNode.countChildren()},debug:function(b){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),am("log",arguments))},findAll:function(b){return this.rootNode.findAll(b)},findFirst:function(b){return this.rootNode.findFirst(b)},findNextNode:function(i,o,n){var m=null,l=o.parent.children,k=null,j=function(p,h,v){var u,t,s=p.children,r=s.length,q=s[h];if(q&&v(q)===!1){return !1}if(q&&q.children&&q.expanded&&j(q,0,v)===!1){return !1}for(u=h+1;r>u;u++){if(j(p,u,v)===!1){return !1}}return t=p.parent,t?j(t,t.children.indexOf(p)+1,v):j(p,0,v)};return i="string"==typeof i?aa(i):i,o=o||this.getFirstChild(),j(o.parent,l.indexOf(o),function(b){return b===m?!1:(m=m||b,ar(b.span).is(":visible")?i(b)&&(k=b,k!==o)?!1:void 0:void b.debug("quicksearch: skipping hidden node"))}),k},generateFormElements:function(s,r,q){q=q||{};var p,o="string"==typeof s?s:"ft_"+this._id+"[]",n="string"==typeof r?r:"ft_"+this._id+"_active",m="fancytree_result_"+this._id,l=ar("#"+m),k=3===this.options.selectMode&&q.stopOnParents!==!1;l.length?l.empty():l=ar("<div>",{id:m}).hide().insertAfter(this.$container),s!==!1&&(p=this.getSelectedNodes(k),ar.each(p,function(d,e){l.append(ar("<input>",{type:"checkbox",name:o,value:e.key,checked:!0}))})),r!==!1&&this.activeNode&&l.append(ar("<input>",{type:"radio",name:n,value:this.activeNode.key,checked:!0}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getNodeByKey:function(f,c){var h,g;return !c&&(h=ap.getElementById(this.options.idPrefix+f))?h.ftnode?h.ftnode:null:(c=c||this.rootNode,g=null,c.visit(function(d){return d.key===f?(g=d,!1):void 0},!0),g)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(b){return this.rootNode.getSelectedNodes(b)},hasFocus:function(){return !!this._hasFocus},info:function(b){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),am("info",arguments))},loadKeyPath:function(E,D,C){function B(e,c,f){D.call(d,c,"loading"),c.load().done(function(){d.loadKeyPath.call(d,v[e],D,c).always(af(f,d))}).fail(function(b){d.warn("loadKeyPath: error loading: "+e+" (parent: "+t+")"),D.call(d,c,"error"),f.reject()})}var A,z,y,x,w,v,u,t,s,m=this.options.keyPathSeparator,d=this;for(D=D||ar.noop,ar.isArray(E)||(E=[E]),v={},y=0;y<E.length;y++){for(t=C||this.rootNode,x=E[y],x.charAt(0)===m&&(x=x.substr(1)),s=x.split(m);s.length;){if(w=s.shift(),u=t._findDirectChild(w),!u){this.warn("loadKeyPath: key not found: "+w+" (parent: "+t+")"),D.call(this,w,"error");break}if(0===s.length){D.call(this,u,"ok");break}if(u.lazy&&u.hasChildren()===ao){D.call(this,u,"loaded"),v[w]?v[w].push(s.join(m)):v[w]=[s.join(m)];break}D.call(this,u,"loaded"),t=u}}A=[];for(w in v){u=t._findDirectChild(w),z=new ar.Deferred,A.push(z),B(w,u,z)}return ar.when.apply(ar,A).promise()},reactivate:function(e){var d,f=this.activeNode;return f?(this.activeNode=null,d=f.setActive(!0,{noFocus:!0}),e&&f.setFocus(),d):ah()},reload:function(b){return this._callHook("treeClear",this),this._callHook("treeLoad",this,b)},render:function(d,c){return this.rootNode.render(d,c)},setFocus:function(b){return this._callHook("treeSetFocus",this,b)},toDict:function(e,d){var f=this.rootNode.toDict(!0,d);return e?f:f.children},toString:function(){return"<Fancytree(#"+this._id+")>"},_triggerNodeEvent:function(h,d,l,k){var j=this._makeHookContext(d,l,k),i=this.widget._trigger(h,l,j);return i!==!1&&j.result!==ao?j.result:i},_triggerTreeEvent:function(g,d,j){var i=this._makeHookContext(this,d,j),h=this.widget._trigger(g,d,i);return h!==!1&&i.result!==ao?i.result:h},visit:function(b){return this.rootNode.visit(b,!1)},warn:function(b){Array.prototype.unshift.call(arguments,this.toString()),am("warn",arguments)}},ar.extend(W.prototype,{nodeClick:function(g){var f,j,i=g.targetType,h=g.node;if("expander"===i){if(h.isLoading()){return void h.debug("Got 2nd click while loading: ignored")}this._callHook("nodeToggleExpanded",g)}else{if("checkbox"===i){this._callHook("nodeToggleSelected",g),g.options.focusOnSelect&&this._callHook("nodeSetFocus",g,!0)}else{if(j=!1,f=!0,h.folder){switch(g.options.clickFolderMode){case 2:j=!0,f=!1;break;case 3:f=!0,j=!0}}f&&(this.nodeSetFocus(g),this._callHook("nodeSetActive",g,!0)),j&&this._callHook("nodeToggleExpanded",g)}}},nodeCollapseSiblings:function(h,g){var l,k,j,i=h.node;if(i.parent){for(l=i.parent.children,k=0,j=l.length;j>k;k++){l[k]!==i&&l[k].expanded&&this._callHook("nodeSetExpanded",l[k],!1,g)}}},nodeDblclick:function(b){"title"===b.targetType&&4===b.options.clickFolderMode&&this._callHook("nodeToggleExpanded",b),"title"===b.targetType&&b.originalEvent.preventDefault()},nodeKeydown:function(E){var D,C,B,A,z=E.originalEvent,y=E.node,x=E.tree,w=E.options,v=z.which,u=String.fromCharCode(v),t=!(z.altKey||z.ctrlKey||z.metaKey||z.shiftKey),s=ar(z.target),r=!0,q=!(z.ctrlKey||!w.autoActivate);if(y||(A=this.getActiveNode()||this.getFirstChild(),A&&(A.setFocus(),y=E.node=this.focusNode,y.debug("Keydown force focus on active node"))),w.quicksearch&&t&&/\w/.test(u)&&!s.is(":input:enabled")){return C=(new Date).getTime(),C-x.lastQuicksearchTime>500&&(x.lastQuicksearchTerm=""),x.lastQuicksearchTime=C,x.lastQuicksearchTerm+=u,D=x.findNextNode(x.lastQuicksearchTerm,x.getActiveNode()),D&&D.setActive(),void z.preventDefault()}switch(Q.eventToString(z)){case"+":case"=":x.nodeSetExpanded(E,!0);break;case"-":x.nodeSetExpanded(E,!1);break;case"space":y.isPagingNode()?x._triggerNodeEvent("clickPaging",E,z):w.checkbox?x.nodeToggleSelected(E):x.nodeSetActive(E,!0);break;case"return":x.nodeSetActive(E,!0);break;case"backspace":case"left":case"right":case"up":case"down":B=y.navigate(z.which,q);break;default:r=!1}r&&z.preventDefault()},nodeLoadChildren:function(e,q){var p,o,n,m=e.tree,l=e.node,k=(new Date).getTime();return ar.isFunction(q)&&(q=q.call(m,{type:"source"},e),an(!ar.isFunction(q),"source callback must not return another function")),q.url&&(l._requestId&&l.warn("Recursive load request #"+k+" while #"+l._requestId+" is pending."),p=ar.extend({},e.options.ajax,q),l._requestId=k,p.debugDelay?(o=p.debugDelay,ar.isArray(o)&&(o=o[0]+Math.random()*(o[1]-o[0])),l.warn("nodeLoadChildren waiting debugDelay "+Math.round(o)+" ms ..."),p.debugDelay=!1,n=ar.Deferred(function(c){setTimeout(function(){ar.ajax(p).done(function(){c.resolveWith(this,arguments)}).fail(function(){c.rejectWith(this,arguments)})},o)})):n=ar.ajax(p),q=new ar.Deferred,n.done(function(r,j,i){var h,c;if("json"!==this.dataType&&"jsonp"!==this.dataType||"string"!=typeof r||ar.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),l._requestId&&l._requestId>k){return void q.rejectWith(this,[K])}if(e.options.postProcess){try{c=m._triggerNodeEvent("postProcess",e,e.originalEvent,{response:r,error:null,dataType:this.dataType})}catch(b){c={error:b,message:""+b,details:"postProcess failed"}}if(c.error){return h=ar.isPlainObject(c.error)?c.error:{message:c.error},h=m._makeHookContext(l,null,h),void q.rejectWith(this,[h])}r=ar.isArray(c)?c:r}else{r&&r.hasOwnProperty("d")&&e.options.enableAspx&&(r="string"==typeof r.d?ar.parseJSON(r.d):r.d)}q.resolveWith(this,[r])}).fail(function(f,c,h){var g=m._makeHookContext(l,null,{error:f,args:Array.prototype.slice.call(arguments),message:h,details:f.status+": "+h});q.rejectWith(this,[g])})),ar.isFunction(q.then)&&ar.isFunction(q["catch"])&&(n=q,q=new ar.Deferred,n.then(function(b){q.resolve(b)},function(b){q.reject(b)})),ar.isFunction(q.promise)&&(m.nodeSetStatus(e,"loading"),q.done(function(b){m.nodeSetStatus(e,"ok"),l._requestId=null}).fail(function(b){var d;return b===K?void l.warn("Ignored response for obsolete load request #"+k+" (expected #"+l._requestId+")"):(b.node&&b.error&&b.message?d=b:(d=m._makeHookContext(l,null,{error:b,args:Array.prototype.slice.call(arguments),message:b?b.message||b.toString():""}),"[object Object]"===d.message&&(d.message="")),l.warn("Load children failed ("+d.message+")",d),void (m._triggerNodeEvent("loadError",d,null)!==!1&&m.nodeSetStatus(e,"error",d.message,d.details)))})),ar.when(q).done(function(d){var f;ar.isPlainObject(d)&&(an(l.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)"),an(ar.isArray(d.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),f=d,d=d.children,delete f.children,ar.extend(m.data,f)),an(ar.isArray(d),"expected array of children"),l._setChildren(d),m._triggerNodeEvent("loadChildren",l)})},nodeLoadKeyPath:function(d,c){},nodeRemoveChild:function(e,o){var n,m=e.node,l=e.options,k=ar.extend({},e,{node:o}),j=m.children;return 1===j.length?(an(o===j[0],"invalid single child"),this.nodeRemoveChildren(e)):(this.activeNode&&(o===this.activeNode||this.activeNode.isDescendantOf(o))&&this.activeNode.setActive(!1),this.focusNode&&(o===this.focusNode||this.focusNode.isDescendantOf(o))&&(this.focusNode=null),this.nodeRemoveMarkup(k),this.nodeRemoveChildren(k),n=ar.inArray(o,j),an(n>=0,"invalid child"),o.visit(function(b){b.parent=null},!0),this._callHook("treeRegisterNode",this,!1,o),l.removeNode&&l.removeNode.call(e.tree,{type:"removeNode"},k),void j.splice(n,1))},nodeRemoveChildMarkup:function(d){var e=d.node;e.ul&&(e.isRootNode()?ar(e.ul).empty():(ar(e.ul).remove(),e.ul=null),e.visit(function(b){b.li=b.ul=null}))},nodeRemoveChildren:function(h){var m,l=h.tree,k=h.node,j=k.children,i=h.options;j&&(this.activeNode&&this.activeNode.isDescendantOf(k)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(k)&&(this.focusNode=null),this.nodeRemoveChildMarkup(h),m=ar.extend({},h),k.visit(function(b){b.parent=null,l._callHook("treeRegisterNode",l,!1,b),i.removeNode&&(m.node=b,i.removeNode.call(h.tree,{type:"removeNode"},m))}),k.lazy?k.children=[]:k.children=null,k.isRootNode()||(k.expanded=!1),this.nodeRenderStatus(h))},nodeRemoveMarkup:function(d){var e=d.node;e.li&&(ar(e.li).remove(),e.li=null),this.nodeRemoveChildMarkup(d)},nodeRender:function(aA,az,ay,ax,aw){var av,au,at,I,H,G,F,E=aA.node,D=aA.tree,C=aA.options,B=C.aria,A=!1,z=E.parent,y=!z,e=E.children,c=null;if(y||z.ul){if(an(y||z.ul,"parent UL must exist"),y||(E.li&&(az||E.li.parentNode!==E.parent.ul)&&(E.li.parentNode===E.parent.ul?c=E.li.nextSibling:this.debug("Unlinking "+E+" (must be child of "+E.parent+")"),this.nodeRemoveMarkup(aA)),E.li?this.nodeRenderStatus(aA):(A=!0,E.li=ap.createElement("li"),E.li.ftnode=E,E.key&&C.generateIds&&(E.li.id=C.idPrefix+E.key),E.span=ap.createElement("span"),E.span.className="fancytree-node",B&&ar(E.span).attr("aria-labelledby","ftal_"+C.idPrefix+E.key),E.li.appendChild(E.span),this.nodeRenderTitle(aA),C.createNode&&C.createNode.call(D,{type:"createNode"},aA)),C.renderNode&&C.renderNode.call(D,{type:"renderNode"},aA)),e){if(y||E.expanded||ay===!0){for(E.ul||(E.ul=ap.createElement("ul"),(ax!==!0||aw)&&E.expanded||(E.ul.style.display="none"),B&&ar(E.ul).attr("role","group"),E.li?E.li.appendChild(E.ul):E.tree.$div.append(E.ul)),I=0,H=e.length;H>I;I++){F=ar.extend({},aA,{node:e[I]}),this.nodeRender(F,az,ay,!1,!0)}for(av=E.ul.firstChild;av;){at=av.ftnode,at&&at.parent!==E?(E.debug("_fixParent: remove missing "+at,av),G=av.nextSibling,av.parentNode.removeChild(av),av=G):av=av.nextSibling}for(av=E.ul.firstChild,I=0,H=e.length-1;H>I;I++){au=e[I],at=av.ftnode,au!==at?E.ul.insertBefore(au.li,at.li):av=av.nextSibling}}}else{E.ul&&(this.warn("remove child markup for "+E),this.nodeRemoveChildMarkup(aA))}y||A&&z.ul.insertBefore(E.li,c)}},nodeRenderTitle:function(C,B){var A,z,y,x,w,v,u=C.node,t=C.tree,s=C.options,r=s.aria,o=u.getLevel(),d=[];B!==ao&&(u.title=B),u.span&&(o<s.minExpandLevel?(u.lazy||(u.expanded=!0),o>1&&(r?d.push("<span role='button' class='fancytree-expander fancytree-expander-fixed'></span>"):d.push("<span class='fancytree-expander fancytree-expander-fixed''></span>"))):r?d.push("<span role='button' class='fancytree-expander'></span>"):d.push("<span class='fancytree-expander'></span>"),s.checkbox&&u.hideCheckbox!==!0&&!u.isStatusNode()&&(r?d.push("<span role='checkbox' class='fancytree-checkbox'></span>"):d.push("<span class='fancytree-checkbox'></span>")),u.data.iconClass!==ao&&(u.icon?ar.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead"):(u.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead"),u.icon=u.data.iconClass)),ar.isFunction(s.icon)?(z=s.icon.call(t,{type:"icon"},C),null==z&&(z=u.icon)):z=null!=u.icon?u.icon:s.icon,null==z?z=!0:"boolean"!=typeof z&&(z=""+z),z!==!1&&(x=r?" role='img'":"","string"==typeof z?O.test(z)?(z="/"===z.charAt(0)?z:(s.imagePath||"")+z,d.push("<img src='"+z+"' class='fancytree-icon' alt='' />")):d.push("<span "+x+" class='fancytree-custom-icon "+z+"'></span>"):d.push("<span "+x+" class='fancytree-icon'></span>")),y="",s.renderTitle&&(y=s.renderTitle.call(t,{type:"renderTitle"},C)||""),y||(v=u.tooltip?" title='"+ad(u.tooltip)+"'":"",A=r?" id='ftal_"+s.idPrefix+u.key+"'":"",x=r?" role='treeitem'":"",w=s.titlesTabbable?" tabindex='0'":"",y="<span "+x+" class='fancytree-title'"+A+v+w+">"+(s.escapeTitles?ad(u.title):u.title)+"</span>"),d.push(y),u.span.innerHTML=d.join(""),this.nodeRenderStatus(C),s.enhanceTitle&&(C.$title=ar(">span.fancytree-title",u.span),y=s.enhanceTitle.call(t,{type:"enhanceTitle"},C)||""))},nodeRenderStatus:function(w){var v=w.node,u=w.tree,t=w.options,s=v.hasChildren(),r=v.isLastSibling(),q=t.aria,p=ar(v.span).find(".fancytree-title"),o=t._classNames,n=[],m=v[u.statusClassPropName];m&&(n.push(o.node),u.activeNode===v&&n.push(o.active),u.focusNode===v?(n.push(o.focused),q&&p.attr("aria-activedescendant",!0)):q&&p.removeAttr("aria-activedescendant"),v.expanded?(n.push(o.expanded),q&&p.attr("aria-expanded",!0)):q&&p.removeAttr("aria-expanded"),v.folder&&n.push(o.folder),s!==!1&&n.push(o.hasChildren),r&&n.push(o.lastsib),v.lazy&&null==v.children&&n.push(o.lazy),v.partload&&n.push(o.partload),v.partsel&&n.push(o.partsel),v.unselectable&&n.push(o.unselectable),v._isLoading&&n.push(o.loading),v._error&&n.push(o.error),v.statusNodeType&&n.push(o.statusNodePrefix+v.statusNodeType),v.selected?(n.push(o.selected),q&&p.attr("aria-selected",!0)):q&&p.attr("aria-selected",!1),v.extraClasses&&n.push(v.extraClasses),s===!1?n.push(o.combinedExpanderPrefix+"n"+(r?"l":"")):n.push(o.combinedExpanderPrefix+(v.expanded?"e":"c")+(v.lazy&&null==v.children?"d":"")+(r?"l":"")),n.push(o.combinedIconPrefix+(v.expanded?"e":"c")+(v.folder?"f":"")),m.className=n.join(" "),v.li&&(v.li.className=r?o.lastsib:""))},nodeSetActive:function(u,t,s){s=s||{};var r,q=u.node,p=u.tree,o=u.options,l=s.noEvents===!0,k=s.noFocus===!0,e=q===p.activeNode;return t=t!==!1,e===t?ah(q):t&&!l&&this._triggerNodeEvent("beforeActivate",q,u.originalEvent)===!1?ag(q,["rejected"]):(t?(p.activeNode&&(an(p.activeNode!==q,"node was active (inconsistency)"),r=ar.extend({},u,{node:p.activeNode}),p.nodeSetActive(r,!1),an(null===p.activeNode,"deactivate was out of sync?")),o.activeVisible&&q.makeVisible({scrollIntoView:!1}),p.activeNode=q,p.nodeRenderStatus(u),k||p.nodeSetFocus(u),l||p._triggerNodeEvent("activate",q,u.originalEvent)):(an(p.activeNode===q,"node was not active (inconsistency)"),p.activeNode=null,this.nodeRenderStatus(u),l||u.tree._triggerNodeEvent("deactivate",q,u.originalEvent)),ah(q))},nodeSetExpanded:function(C,B,A){A=A||{};var z,y,x,w,v,u,t=C.node,s=C.tree,l=C.options,k=A.noAnimation===!0,d=A.noEvents===!0;if(B=B!==!1,t.expanded&&B||!t.expanded&&!B){return ah(t)}if(B&&!t.lazy&&!t.hasChildren()){return ah(t)}if(!B&&t.getLevel()<l.minExpandLevel){return ag(t,["locked"])}if(!d&&this._triggerNodeEvent("beforeExpand",t,C.originalEvent)===!1){return ag(t,["rejected"])}if(k||t.isVisible()||(k=A.noAnimation=!0),y=new ar.Deferred,B&&!t.expanded&&l.autoCollapse){v=t.getParentList(!1,!0),u=l.autoCollapse;try{for(l.autoCollapse=!1,x=0,w=v.length;w>x;x++){this._callHook("nodeCollapseSiblings",v[x],A)}}finally{l.autoCollapse=u}}return y.done(function(){var b=t.getLastChild();B&&l.autoScroll&&!k&&b?b.scrollIntoView(!0,{topNode:t}).always(function(){d||C.tree._triggerNodeEvent(B?"expand":"collapse",C)}):d||C.tree._triggerNodeEvent(B?"expand":"collapse",C)}),z=function(i){var h,c,b=l.toggleEffect;if(t.expanded=B,s._callHook("nodeRender",C,!1,!1,!0),t.ul){if(h="none"!==t.ul.style.display,c=!!t.expanded,h===c){t.warn("nodeSetExpanded: UL.style.display already set")}else{if(b&&!k){return void ar(t.ul).toggle(b.effect,b.options,b.duration,function(){i()})}t.ul.style.display=t.expanded||!parent?"":"none"}}i()},B&&t.lazy&&t.hasChildren()===ao?t.load().done(function(){y.notifyWith&&y.notifyWith(t,["loaded"]),z(function(){y.resolveWith(t)})}).fail(function(b){z(function(){y.rejectWith(t,["load failed ("+b+")"])})}):z(function(){y.resolveWith(t)}),y.promise()},nodeSetFocus:function(c,k){var j,i=c.tree,h=c.node;if(k=k!==!1,i.focusNode){if(i.focusNode===h&&k){return}j=ar.extend({},c,{node:i.focusNode}),i.focusNode=null,this._triggerNodeEvent("blur",j),this._callHook("nodeRenderStatus",j)}k&&(this.hasFocus()||(h.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",c,!0,{calledByNode:!0})),h.makeVisible({scrollIntoView:!1}),i.focusNode=h,i.options.titlesTabbable?ar(h.span).find(".fancytree-title").focus():0===ar(ap.activeElement).closest(".fancytree-container").length&&ar(i.$container).focus(),this._triggerNodeEvent("focus",c),c.options.autoScroll&&h.scrollIntoView(),this._callHook("nodeRenderStatus",c))},nodeSetSelected:function(g,f){var j=g.node,i=g.tree,h=g.options;if(f=f!==!1,j.debug("nodeSetSelected("+f+")",g),!j.unselectable){if(j.selected&&f||!j.selected&&!f){return !!j.selected}if(this._triggerNodeEvent("beforeSelect",j,g.originalEvent)===!1){return !!j.selected}f&&1===h.selectMode?i.lastSelectedNode&&i.lastSelectedNode.setSelected(!1):3===h.selectMode&&(j.selected=f,j.fixSelection3AfterClick()),j.selected=f,this.nodeRenderStatus(g),i.lastSelectedNode=f?j:null,i._triggerNodeEvent("select",g)}},nodeSetStatus:function(j,q,p,o){function n(){var d=l.children?l.children[0]:null;if(d&&d.isStatusNode()){try{l.ul&&(l.ul.removeChild(d.li),d.li=null)}catch(c){}1===l.children.length?l.children=[]:l.children.shift()}}function m(e,g){var f=l.children?l.children[0]:null;return f&&f.isStatusNode()?(ar.extend(f,e),f.statusNodeType=g,k._callHook("nodeRenderTitle",f)):(l._setChildren([e]),l.children[0].statusNodeType=g,k.render()),l.children[0]}var l=j.node,k=j.tree;switch(q){case"ok":n(),l._isLoading=!1,l._error=null,l.renderStatus();break;case"loading":l.parent||m({title:k.options.strings.loading+(p?" ("+p+")":""),checkbox:!1,tooltip:o},q),l._isLoading=!0,l._error=null,l.renderStatus();break;case"error":m({title:k.options.strings.loadError+(p?" ("+p+")":""),checkbox:!1,tooltip:o},q),l._isLoading=!1,l._error={message:p,details:o},l.renderStatus();break;case"nodata":m({title:k.options.strings.noData,checkbox:!1,tooltip:o},q),l._isLoading=!1,l._error=null,l.renderStatus();break;default:ar.error("invalid node status "+q)}},nodeToggleExpanded:function(b){return this.nodeSetExpanded(b,!b.node.expanded)},nodeToggleSelected:function(b){return this.nodeSetSelected(b,!b.node.selected)},treeClear:function(d){var c=d.tree;c.activeNode=null,c.focusNode=null,c.$div.find(">ul.fancytree-container").empty(),c.rootNode.children=null},treeCreate:function(b){},treeDestroy:function(b){this.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("ui-helper-hidden")},treeInit:function(b){this.treeLoad(b)},treeLoad:function(j,q){var p,o,n,m=j.tree,l=j.widget.element,k=ar.extend({},j,{node:this.rootNode});if(m.rootNode.children&&this.treeClear(j),q=q||this.options.source){"string"==typeof q&&ar.error("Not implemented")}else{switch(p=l.data("type")||"html"){case"html":o=l.find(">ul:first"),o.addClass("ui-fancytree-source ui-helper-hidden"),q=ar.ui.fancytree.parseHtml(o),this.data=ar.extend(this.data,ae(o));break;case"json":q=ar.parseJSON(l.text()),q.children&&(q.title&&(m.title=q.title),q=q.children);break;default:ar.error("Invalid data-type: "+p)}}return n=this.nodeLoadChildren(k,q).done(function(){m.render(),3===j.options.selectMode&&m.rootNode.fixSelection3FromEndNodes(),m.activeNode&&m.options.activeVisible&&m.activeNode.makeVisible(),m._triggerTreeEvent("init",null,{status:!0})}).fail(function(){m.render(),m._triggerTreeEvent("init",null,{status:!1})})},treeRegisterNode:function(e,d,f){},treeSetFocus:function(e,g,f){g=g!==!1,g!==this.hasFocus()&&(this._hasFocus=g,!g&&this.focusNode?this.focusNode.setFocus(!1):!g||f&&f.calledByNode||ar(this.$container).focus(),this.$container.toggleClass("fancytree-treefocus",g),this._triggerTreeEvent(g?"focusTree":"blurTree"))}}),ar.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!1,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,debugLevel:null,disabled:!1,enableAspx:!0,escapeTitles:!1,extensions:[],toggleEffect:{effect:"blind",options:{direction:"vertical",scale:"box"},duration:200},generateIds:!1,icon:!0,idPrefix:"ft_",focusOnSelect:!1,keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,quicksearch:!1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading&#8230;",loadError:"Load error!",moreData:"More&#8230;",noData:"No data."},tabindex:"0",titlesTabbable:!1,_classNames:{node:"fancytree-node",folder:"fancytree-folder",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",hasChildren:"fancytree-has-children",active:"fancytree-active",selected:"fancytree-selected",expanded:"fancytree-expanded",lazy:"fancytree-lazy",focused:"fancytree-focused",partload:"fancytree-partload",partsel:"fancytree-partsel",unselectable:"fancytree-unselectable",lastsib:"fancytree-lastsib",loading:"fancytree-loading",error:"fancytree-error",statusNodePrefix:"fancytree-statusnode-"},lazyLoad:null,postProcess:null},_create:function(){this.tree=new W(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul:first");var d,m,l,k=this.options,j=k.extensions,e=this.tree;for(l=0;l<j.length;l++){m=j[l],d=ar.ui.fancytree._extensions[m],d||ar.error("Could not apply extension '"+m+"' (it is not registered, did you forget to include it?)"),this.tree.options[m]=ar.extend(!0,{},d.options,this.tree.options[m]),an(this.tree.ext[m]===ao,"Extension name must not exist as Fancytree.ext attribute: '"+m+"'"),this.tree.ext[m]={},ai(this.tree,e,d,m),e=d}k.icons!==ao&&(k.icon!==!0?ar.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead"),k.icon=k.icons)),k.iconClass!==ao&&(k.icon?ar.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead"),k.icon=k.iconClass)),k.tabbable!==ao&&(k.tabindex=k.tabbable?"0":"-1",this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+k.tabindex+"' instead")),this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree),this._bind()},_setOption:function(f,i){var h=!0,g=!1;switch(f){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":this.tree._callHook("treeCreate",this.tree),g=!0;break;case"escapeTitles":g=!0;break;case"source":h=!1,this.tree._callHook("treeLoad",this.tree,i)}this.tree.debug("set option "+f+"="+i+" <"+typeof i+">"),h&&ar.Widget.prototype._setOption.apply(this,arguments),g&&this.tree.render(!0,!1)},destroy:function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree),ar.Widget.prototype.destroy.call(this)},_unbind:function(){var c=this.tree._ns;this.element.unbind(c),this.tree.$container.unbind(c),ar(ap).unbind(c)},_bind:function(){var f=this,e=this.options,h=this.tree,g=h._ns;this._unbind(),h.$container.on("focusin"+g+" focusout"+g,function(i){var c=Q.getNode(i),j="focusin"===i.type;c?h._callHook("nodeSetFocus",c,j):h._callHook("treeSetFocus",h,j)}).on("selectstart"+g,"span.fancytree-title",function(b){b.preventDefault()}).on("keydown"+g,function(b){if(e.disabled||e.keyboard===!1){return !0}var k,j=h.focusNode,i=h._makeHookContext(j||h,b),c=h.phase;try{return h.phase="userEvent",k=j?h._triggerNodeEvent("keydown",j,b):h._triggerTreeEvent("keydown",b),"preventNav"===k?k=!0:k!==!1&&(k=h._callHook("nodeKeydown",i)),k}finally{h.phase=c}}).on("click"+g+" dblclick"+g,function(m){if(e.disabled){return !0}var l,k=Q.getEventTarget(m),j=k.node,i=f.tree,b=i.phase;if(!j){return !0}l=i._makeHookContext(j,m);try{switch(i.phase="userEvent",m.type){case"click":return l.targetType=k.type,j.isPagingNode()?i._triggerNodeEvent("clickPaging",l,m)===!0:i._triggerNodeEvent("click",l,m)===!1?!1:i._callHook("nodeClick",l);case"dblclick":return l.targetType=k.type,i._triggerNodeEvent("dblclick",l,m)===!1?!1:i._callHook("nodeDblclick",l)}}finally{i.phase=b}})},getActiveNode:function(){return this.tree.activeNode},getNodeByKey:function(b){return this.tree.getNodeByKey(b)},getRootNode:function(){return this.tree.rootNode},getTree:function(){return this.tree}}),Q=ar.ui.fancytree,ar.extend(ar.ui.fancytree,{version:"2.18.0",buildType:"production",debugLevel:1,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:W,_FancytreeNodeClass:Y,jquerySupports:{positionMyOfs:ak(ar.ui.version,1,9)},assert:function(d,c){return an(d,c)},debounce:function(g,f,j,i){var h;return 3===arguments.length&&"boolean"!=typeof j&&(i=j,j=!1),function(){var b=arguments;i=i||this,j&&!h&&f.apply(i,b),clearTimeout(h),h=setTimeout(function(){j||f.apply(i,b),h=null},g)}},debug:function(c){ar.ui.fancytree.debugLevel>=2&&am("log",arguments)},error:function(b){am("error",arguments)},escapeHtml:ad,fixPositionOptions:function(g){if((g.offset||(""+g.my+g.at).indexOf("%")>=0)&&ar.error("expected new position syntax (but '%' is not supported)"),!ar.ui.fancytree.jquerySupports.positionMyOfs){var k=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(g.my),j=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(g.at),i=(k[2]?+k[2]:0)+(j[2]?+j[2]:0),h=(k[4]?+k[4]:0)+(j[4]?+j[4]:0);g=ar.extend({},g,{my:k[1]+" "+k[3],at:j[1]+" "+j[3]}),(i||h)&&(g.offset=""+i+" "+h)}return g},getEventTargetType:function(b){return this.getEventTarget(b).type},getEventTarget:function(d){var g=d&&d.target?d.target.className:"",f={node:this.getNode(d.target),type:ao};return/\bfancytree-title\b/.test(g)?f.type="title":/\bfancytree-expander\b/.test(g)?f.type=f.node.hasChildren()===!1?"prefix":"expander":/\bfancytree-checkbox\b/.test(g)||/\bfancytree-radio\b/.test(g)?f.type="checkbox":/\bfancytree-icon\b/.test(g)?f.type="icon":/\bfancytree-node\b/.test(g)?f.type="title":d&&d.target&&ar(d.target).closest(".fancytree-title").length&&(f.type="title"),f},getNode:function(b){if(b instanceof Y){return b}for(b.selector!==ao?b=b[0]:b.originalEvent!==ao&&(b=b.target);b;){if(b.ftnode){return b.ftnode}b=b.parentNode}return null},getTree:function(d){var e;return d instanceof W?d:(d===ao&&(d=0),"number"==typeof d?d=ar(".fancytree-container").eq(d):"string"==typeof d?d=ar(d).eq(0):d.selector!==ao?d=d.eq(0):d.originalEvent!==ao&&(d=ar(d.target)),d=d.closest(":ui-fancytree"),e=d.data("ui-fancytree")||d.data("fancytree"),e?e.tree:null)},info:function(c){ar.ui.fancytree.debugLevel>=1&&am("info",arguments)},eventToString:function(f){var e=f.which,h=f.type,g=[];return f.altKey&&g.push("alt"),f.ctrlKey&&g.push("ctrl"),f.metaKey&&g.push("meta"),f.shiftKey&&g.push("shift"),"click"===h||"dblclick"===h?g.push(X[f.button]+h):ab[e]||g.push(Z[e]||String.fromCharCode(e).toLowerCase()),g.join("+")},keyEventToString:function(b){return this.warn("keyEventToString() is deprecated: use eventToString()"),this.eventToString(b)},parseHtml:function(w){var v,u,t,s,r,q,p,o,n=w.find(">li"),d=[];return n.each(function(){var b,h,g=ar(this),f=g.find(">span:first",this),e=f.length?null:g.find(">a:first"),c={tooltip:null,data:{}};for(f.length?c.title=f.html():e&&e.length?(c.title=e.html(),c.data.href=e.attr("href"),c.data.target=e.attr("target"),c.tooltip=e.attr("title")):(c.title=g.html(),r=c.title.search(/<ul/i),r>=0&&(c.title=c.title.substring(0,r))),c.title=ar.trim(c.title),s=0,q=V.length;q>s;s++){c[V[s]]=ao}for(v=this.className.split(" "),t=[],s=0,q=v.length;q>s;s++){u=v[s],T[u]?c[u]=!0:t.push(u)}if(c.extraClasses=t.join(" "),p=g.attr("title"),p&&(c.tooltip=p),p=g.attr("id"),p&&(c.key=p),b=ae(g),b&&!ar.isEmptyObject(b)){for(h in N){b.hasOwnProperty(h)&&(b[N[h]]=b[h],delete b[h])}for(s=0,q=R.length;q>s;s++){p=R[s],o=b[p],null!=o&&(delete b[p],c[p]=o)}ar.extend(c.data,b)}w=g.find(">ul:first"),w.length?c.children=ar.ui.fancytree.parseHtml(w):c.children=c.lazy?ao:null,d.push(c)}),d},registerExtension:function(c){an(null!=c.name,"extensions must have a `name` property."),an(null!=c.version,"extensions must have a `version` property."),ar.ui.fancytree._extensions[c.name]=c},unescapeHtml:function(d){var c=ap.createElement("div");return c.innerHTML=d,0===c.childNodes.length?"":c.childNodes[0].nodeValue},warn:function(b){am("warn",arguments)}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.childcounter.min.js' */
;!function(d,c){d.ui.fancytree._FancytreeClass.prototype.countSelected=function(f){var e=this;e.options;return e.getSelectedNodes(f).length},d.ui.fancytree._FancytreeNodeClass.prototype.updateCounters=function(){var f=this,i=d("span.fancytree-childcounter",f.span),h=f.tree.options.childcounter,g=f.countChildren(h.deep);f.data.childCounter=g,!g&&h.hideZeros||f.isExpanded()&&h.hideExpanded?i.remove():(i.length||(i=d("<span class='fancytree-childcounter'/>").appendTo(d("span.fancytree-icon",f.span))),i.text(g)),!h.deep||f.isTopLevel()||f.isRoot()||f.parent.updateCounters()},d.ui.fancytree.prototype.widgetMethod1=function(b){this.tree;return b},d.ui.fancytree.registerExtension({name:"childcounter",version:"1.0.0",options:{deep:!0,hideZeros:!0,hideExpanded:!1},foo:42,_appendCounter:function(b){},treeInit:function(b){b.options,b.options.childcounter;this._superApply(arguments),this.$container.addClass("fancytree-ext-childcounter")},treeDestroy:function(b){this._superApply(arguments)},nodeRenderTitle:function(g,k){var j=g.node,i=g.options.childcounter,h=null==j.data.childCounter?j.countChildren(i.deep):+j.data.childCounter;this._superApply(arguments),!h&&i.hideZeros||j.isExpanded()&&i.hideExpanded||d("span.fancytree-icon",j.span).append(d("<span class='fancytree-childcounter'/>").text(h))},nodeSetExpanded:function(f,e,h){var g=f.tree;f.node;return this._superApply(arguments).always(function(){g.nodeRenderTitle(f)})}})}(jQuery);
/*! Extension 'jquery.fancytree.clones.min.js' */
;!function(j,i,p,o){function n(d,e){d||(e=e?": "+e:"",j.error("Assertion failed"+e))}function m(e,d){var f;for(f=e.length-1;f>=0;f--){if(e[f]===d){return e.splice(f,1),!0}}return !1}function l(A,z,y){for(var x,w,v=3&A.length,u=A.length-v,t=y,s=3432918353,r=461845907,q=0;u>q;){w=255&A.charCodeAt(q)|(255&A.charCodeAt(++q))<<8|(255&A.charCodeAt(++q))<<16|(255&A.charCodeAt(++q))<<24,++q,w=(65535&w)*s+(((w>>>16)*s&65535)<<16)&4294967295,w=w<<15|w>>>17,w=(65535&w)*r+(((w>>>16)*r&65535)<<16)&4294967295,t^=w,t=t<<13|t>>>19,x=5*(65535&t)+((5*(t>>>16)&65535)<<16)&4294967295,t=(65535&x)+27492+(((x>>>16)+58964&65535)<<16)}switch(w=0,v){case 3:w^=(255&A.charCodeAt(q+2))<<16;case 2:w^=(255&A.charCodeAt(q+1))<<8;case 1:w^=255&A.charCodeAt(q),w=(65535&w)*s+(((w>>>16)*s&65535)<<16)&4294967295,w=w<<15|w>>>17,w=(65535&w)*r+(((w>>>16)*r&65535)<<16)&4294967295,t^=w}return t^=A.length,t^=t>>>16,t=2246822507*(65535&t)+((2246822507*(t>>>16)&65535)<<16)&4294967295,t^=t>>>13,t=3266489909*(65535&t)+((3266489909*(t>>>16)&65535)<<16)&4294967295,t^=t>>>16,z?("0000000"+(t>>>0).toString(16)).substr(-8):t>>>0}function k(e){var g,f=j.map(e.getParentList(!1,!0),function(b){return b.refKey||b.key});return f=f.join("/"),g="id_"+l(f,!0)}j.ui.fancytree._FancytreeNodeClass.prototype.getCloneList=function(g){var s,r=this.tree,q=r.refMap[this.refKey]||null,h=r.keyMap;return q&&(s=this.key,g?q=j.map(q,function(b){return h[b]}):(q=j.map(q,function(b){return b===s?null:h[b]}),q.length<1&&(q=null))),q},j.ui.fancytree._FancytreeNodeClass.prototype.isClone=function(){var d=this.refKey||null,c=d&&this.tree.refMap[d]||null;return !!(c&&c.length>1)},j.ui.fancytree._FancytreeNodeClass.prototype.reRegister=function(y,x){y=null==y?null:""+y,x=null==x?null:""+x;var w=this.tree,v=this.key,u=this.refKey,t=w.keyMap,s=w.refMap,r=s[u]||null,q=!1;return null!=y&&y!==this.key&&(t[y]&&j.error("[ext-clones] reRegister("+y+"): already exists: "+this),delete t[v],t[y]=this,r&&(s[u]=j.map(r,function(b){return b===v?y:b})),this.key=y,q=!0),null!=x&&x!==this.refKey&&(r&&(1===r.length?delete s[u]:s[u]=j.map(r,function(b){return b===v?null:b})),s[x]?s[x].append(y):s[x]=[this.key],this.refKey=x,q=!0),q},j.ui.fancytree._FancytreeNodeClass.prototype.setRefKey=function(b){return this.reRegister(null,b)},j.ui.fancytree._FancytreeClass.prototype.getNodesByRef=function(f,q){var h=this.keyMap,g=this.refMap[f]||null;return g&&(g=q?j.map(g,function(d){var c=h[d];return c.isDescendantOf(q)?c:null}):j.map(g,function(b){return h[b]}),g.length<1&&(g=null)),g},j.ui.fancytree._FancytreeClass.prototype.changeRefKey=function(h,g){var t,s,r=this.keyMap,q=this.refMap[h]||null;if(q){for(t=0;t<q.length;t++){s=r[q[t]],s.refKey=g}delete this.refMap[h],this.refMap[g]=q}},j.ui.fancytree.registerExtension({name:"clones",version:"0.0.3",options:{highlightActiveClones:!0,highlightClones:!1},treeCreate:function(b){this._superApply(arguments),b.tree.refMap={},b.tree.keyMap={}},treeInit:function(b){this.$container.addClass("fancytree-ext-clones"),n(null==b.options.defaultKey),b.options.defaultKey=function(c){return k(c)},this._superApply(arguments)},treeClear:function(b){return b.tree.refMap={},b.tree.keyMap={},this._superApply(arguments)},treeRegisterNode:function(x,w,v){var u,t,s=x.tree,r=s.keyMap,q=s.refMap,f=v.key,e=v&&null!=v.refKey?""+v.refKey:null;return v.isStatusNode()?this._superApply(arguments):(w?(null!=r[v.key]&&j.error("clones.treeRegisterNode: node.key already exists: "+v),r[f]=v,e&&(u=q[e],u?(u.push(f),2===u.length&&x.options.clones.highlightClones&&r[u[0]].renderStatus()):q[e]=[f])):(null==r[f]&&j.error("clones.treeRegisterNode: node.key not registered: "+v.key),delete r[f],e&&(u=q[e],u&&(t=u.length,1>=t?(n(1===t),n(u[0]===f),delete q[e]):(m(u,f),2===t&&x.options.clones.highlightClones&&r[u[0]].renderStatus())))),this._superApply(arguments))},nodeRenderStatus:function(f){var q,h,g=f.node;return h=this._superApply(arguments),f.options.clones.highlightClones&&(q=j(g[f.tree.statusClassPropName]),q.length&&g.isClone()&&q.addClass("fancytree-clone")),h},nodeSetActive:function(g,s){var r,q=g.tree.statusClassPropName,h=g.node;return r=this._superApply(arguments),g.options.clones.highlightActiveClones&&h.isClone()&&j.each(h.getCloneList(!0),function(c,e){j(e[q]).toggleClass("fancytree-active-clone",s!==!1)}),r}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.dnd.min.js' */
;!function(B,A,z,y){function x(b){return 0===b?"":b>0?"+"+b:""+b}function w(){u||(B.ui.plugin.add("draggable","connectToFancytree",{start:function(f,i){var h=B(this).data("ui-draggable")||B(this).data("draggable"),g=i.helper.data("ftSourceNode")||null;return g?(h.offset.click.top=-2,h.offset.click.left=16,g.tree.ext.dnd._onDragEvent("start",g,null,f,i,h)):void 0},drag:function(I,H){var G,F,E,D=B(this).data("ui-draggable")||B(this).data("draggable"),C=H.helper.data("ftSourceNode")||null,n=H.helper.data("ftTargetNode")||null,m=B.ui.fancytree.getNode(I.target),l=C&&C.tree.options.dnd;return I.target&&!m&&(F=B(I.target).closest("div.fancytree-drag-helper,#fancytree-drop-marker").length>0)?(E=C||n||B.ui.fancytree,void E.debug("Drag event over helper: ignored.")):(H.helper.data("ftTargetNode",m),l&&l.updateHelper&&(G=C.tree._makeHookContext(C,I,{otherNode:m,ui:H,draggable:D,dropMarker:B("#fancytree-drop-marker")}),l.updateHelper.call(C.tree,C,G)),n&&n!==m&&n.tree.ext.dnd._onDragEvent("leave",n,C,I,H,D),void (m&&m.tree.options.dnd.dragDrop&&(m===n?m.tree.ext.dnd._onDragEvent("over",m,C,I,H,D):(m.tree.ext.dnd._onDragEvent("enter",m,C,I,H,D),m.tree.ext.dnd._onDragEvent("over",m,C,I,H,D)))))},stop:function(i,C){var n,m=B(this).data("ui-draggable")||B(this).data("draggable"),l=C.helper.data("ftSourceNode")||null,k=C.helper.data("ftTargetNode")||null,j="mouseup"===i.type&&1===i.which;j||(n=l||k||B.ui.fancytree,n.debug("Drag was cancelled")),k&&(j&&k.tree.ext.dnd._onDragEvent("drop",k,l,i,C,m),k.tree.ext.dnd._onDragEvent("leave",k,l,i,C,m)),l&&l.tree.ext.dnd._onDragEvent("stop",l,null,i,C,m)}}),u=!0)}function v(e){var g=e.options.dnd||null,f=e.options.glyph||null;g&&w(),g&&g.dragStart&&e.widget.element.draggable(B.extend({addClasses:!1,appendTo:e.$container,containment:!1,delay:0,distance:4,revert:!1,scroll:!0,scrollSpeed:7,scrollSensitivity:10,connectToFancytree:!0,helper:function(d){var k,j,i,h=B.ui.fancytree.getNode(d.target);return h?(i=h.tree.options.dnd,j=B(h.span),k=B("<div class='fancytree-drag-helper'><span class='fancytree-drag-helper-img' /></div>").css({zIndex:3,position:"relative"}).append(j.find("span.fancytree-title").clone()),k.data("ftSourceNode",h),f&&k.find(".fancytree-drag-helper-img").addClass(f.map.dragHelper),i.initHelper&&i.initHelper.call(h.tree,h,{node:h,tree:h.tree,originalEvent:d,ui:{helper:k}}),k):"<div>ERROR?: helper requested but sourceNode not found</div>"},start:function(h,d){var i=d.helper.data("ftSourceNode");return !!i}},e.options.dnd.draggable)),g&&g.dragDrop&&e.widget.element.droppable(B.extend({addClasses:!1,tolerance:"intersect",greedy:!1},e.options.dnd.droppable))}var u=!1,t="fancytree-drop-accept",s="fancytree-drop-after",r="fancytree-drop-before",q="fancytree-drop-over",p="fancytree-drop-reject",o="fancytree-drop-target";B.ui.fancytree.registerExtension({name:"dnd",version:"0.3.0",options:{autoExpandMS:1000,draggable:null,droppable:null,focusOnClick:!1,preventVoidMoves:!0,preventRecursiveMoves:!0,smartRevert:!0,dragStart:null,dragStop:null,initHelper:null,updateHelper:null,dragEnter:null,dragOver:null,dragExpand:null,dragDrop:null,dragLeave:null},treeInit:function(d){var e=d.tree;this._superApply(arguments),e.options.dnd.dragStart&&e.$container.on("mousedown",function(f){if(d.options.dnd.focusOnClick){var b=B.ui.fancytree.getNode(f);b&&b.debug("Re-enable focus that was prevented by jQuery UI draggable."),setTimeout(function(){B(f.target).closest(":tabbable").focus()},10)}}),v(e)},_setDndStatus:function(E,D,C,n,m){var l=0,k="center",j=this._local,i=this.options.glyph||null,e=E?B(E.span):null,F=B(D.span);if(j.$dropMarker||(j.$dropMarker=B("<div id='fancytree-drop-marker'></div>").hide().css({"z-index":1000}).prependTo(B(this.$div).parent()),i&&j.$dropMarker.addClass(i.map.dropMarker)),"after"===n||"before"===n||"over"===n){switch(n){case"before":k="top";break;case"after":k="bottom";break;default:l=8}j.$dropMarker.toggleClass(s,"after"===n).toggleClass(q,"over"===n).toggleClass(r,"before"===n).show().position(B.ui.fancytree.fixPositionOptions({my:"left"+x(l)+" center",at:"left "+k,of:F}))}else{j.$dropMarker.hide()}e&&e.toggleClass(t,m===!0).toggleClass(p,m===!1),F.toggleClass(o,"after"===n||"before"===n||"over"===n).toggleClass(s,"after"===n).toggleClass(r,"before"===n).toggleClass(t,m===!0).toggleClass(p,m===!1),C.toggleClass(t,m===!0).toggleClass(p,m===!1)},_onDragEvent:function(U,T,S,R,Q,P){var O,N,M,L,K,J,I,H,G,F=this.options,E=F.dnd,D=this._makeHookContext(T,R,{otherNode:S,ui:Q,draggable:P}),C=null,d=this,c=B(T.span);switch(E.smartRevert&&(P.options.revert="invalid"),U){case"start":T.isStatusNode()?C=!1:E.dragStart&&(C=E.dragStart(T,D)),C===!1?(this.debug("tree.dragStart() cancelled"),Q.helper.trigger("mouseup").hide()):(E.smartRevert&&(L=T[D.tree.nodeContainerAttrName].getBoundingClientRect(),M=B(P.options.appendTo)[0].getBoundingClientRect(),P.originalPosition.left=Math.max(0,L.left-M.left),P.originalPosition.top=Math.max(0,L.top-M.top)),c.addClass("fancytree-drag-source"),B(z).on("keydown.fancytree-dnd,mousedown.fancytree-dnd",function(e){"keydown"===e.type&&e.which===B.ui.keyCode.ESCAPE?d.ext.dnd._cancelDrag():"mousedown"===e.type&&d.ext.dnd._cancelDrag()}));break;case"enter":G=E.preventRecursiveMoves&&T.isDescendantOf(S)?!1:E.dragEnter?E.dragEnter(T,D):null,C=G?B.isArray(G)?{over:B.inArray("over",G)>=0,before:B.inArray("before",G)>=0,after:B.inArray("after",G)>=0}:{over:G===!0||"over"===G,before:G===!0||"before"===G,after:G===!0||"after"===G}:!1,Q.helper.data("enterResponse",C);break;case"over":I=Q.helper.data("enterResponse"),H=null,I===!1||("string"==typeof I?H=I:(N=c.offset(),K={x:R.pageX-N.left,y:R.pageY-N.top},J={x:K.x/c.width(),y:K.y/c.height()},I.after&&J.y>0.75?H="after":!I.over&&I.after&&J.y>0.5?H="after":I.before&&J.y<=0.25?H="before":!I.over&&I.before&&J.y<=0.5?H="before":I.over&&(H="over"),E.preventVoidMoves&&(T===S?(this.debug("    drop over source node prevented"),H=null):"before"===H&&S&&T===S.getNextSibling()?(this.debug("    drop after source node prevented"),H=null):"after"===H&&S&&T===S.getPrevSibling()?(this.debug("    drop before source node prevented"),H=null):"over"===H&&S&&S.parent===T&&S.isLastSibling()&&(this.debug("    drop last child over own parent prevented"),H=null)),Q.helper.data("hitMode",H))),"before"===H||"after"===H||!E.autoExpandMS||T.hasChildren()===!1||T.expanded||E.dragExpand&&E.dragExpand(T,D)===!1||T.scheduleAction("expand",E.autoExpandMS),H&&E.dragOver&&(D.hitMode=H,C=E.dragOver(T,D)),O=C!==!1&&null!==H,E.smartRevert&&(P.options.revert=!O),this._local._setDndStatus(S,T,Q.helper,H,O);break;case"drop":H=Q.helper.data("hitMode"),H&&E.dragDrop&&(D.hitMode=H,E.dragDrop(T,D));break;case"leave":T.scheduleAction("cancel"),Q.helper.data("enterResponse",null),Q.helper.data("hitMode",null),this._local._setDndStatus(S,T,Q.helper,"out",y),E.dragLeave&&E.dragLeave(T,D);break;case"stop":c.removeClass("fancytree-drag-source"),B(z).off(".fancytree-dnd"),E.dragStop&&E.dragStop(T,D);break;default:B.error("Unsupported drag event: "+U)}return C},_cancelDrag:function(){var c=B.ui.ddmanager.current;c&&c.cancel()}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.edit.min.js' */
;!function(i,h,n,m){var l=/Mac/.test(navigator.platform),k=i.ui.fancytree.escapeHtml,j=i.ui.fancytree.unescapeHtml;i.ui.fancytree._FancytreeNodeClass.prototype.editStart=function(){var c,s=this,r=this.tree,q=r.ext.edit,p=r.options.edit,o=i(".fancytree-title",s.span),g={node:s,tree:r,options:r.options,isNew:i(s[r.statusClassPropName]).hasClass("fancytree-edit-new"),orgTitle:s.title,input:null,dirty:!1};return p.beforeEdit.call(s,{type:"beforeEdit"},g)===!1?!1:(i.ui.fancytree.assert(!q.currentNode,"recursive edit"),q.currentNode=this,q.eventData=g,r.widget._unbind(),i(n).on("mousedown.fancytree-edit",function(d){i(d.target).hasClass("fancytree-edit-input")||s.editEnd(!0,d)}),c=i("<input />",{"class":"fancytree-edit-input",type:"text",value:r.options.escapeTitles?g.orgTitle:j(g.orgTitle)}),q.eventData.input=c,null!=p.adjustWidthOfs&&c.width(o.width()+p.adjustWidthOfs),null!=p.inputCss&&c.css(p.inputCss),o.html(c),c.focus().change(function(b){c.addClass("fancytree-edit-dirty")}).keydown(function(d){switch(d.which){case i.ui.keyCode.ESCAPE:s.editEnd(!1,d);break;case i.ui.keyCode.ENTER:return s.editEnd(!0,d),!1}d.stopPropagation()}).blur(function(b){return s.editEnd(!0,b)}),void p.edit.call(s,{type:"edit"},g))},i.ui.fancytree._FancytreeNodeClass.prototype.editEnd=function(v,u){var t,s=this,r=this.tree,q=r.ext.edit,p=q.eventData,o=r.options.edit,f=i(".fancytree-title",s.span),c=f.find("input.fancytree-edit-input");return o.trim&&c.val(i.trim(c.val())),t=c.val(),p.dirty=t!==s.title,v===!1?p.save=!1:p.isNew?p.save=""!==t:p.save=p.dirty&&""!==t,o.beforeClose.call(s,{type:"beforeClose"},p)===!1?!1:p.save&&o.save.call(s,{type:"save"},p)===!1?!1:(c.removeClass("fancytree-edit-dirty").unbind(),i(n).off(".fancytree-edit"),p.save?(s.setTitle(r.options.escapeTitles?t:k(t)),s.setFocus()):p.isNew?(s.remove(),s=p.node=null,q.relatedNode.setFocus()):(s.renderTitle(),s.setFocus()),q.eventData=null,q.currentNode=null,q.relatedNode=null,r.widget._bind(),i(r.$container).focus(),p.input=null,o.close.call(s,{type:"close"},p),!0)},i.ui.fancytree._FancytreeNodeClass.prototype.editCreateNode=function(g,r){var q,p=this.tree,o=this;return g=g||"child",null==r?r={title:""}:"string"==typeof r?r={title:r}:i.ui.fancytree.assert(i.isPlainObject(r)),"child"!==g||this.isExpanded()||this.hasChildren()===!1?(q=this.addNode(r,g),void q.makeVisible().done(function(){i(q[p.statusClassPropName]).addClass("fancytree-edit-new"),o.tree.ext.edit.relatedNode=o,q.editStart()})):void this.setExpanded().done(function(){o.editCreateNode(g,r)})},i.ui.fancytree._FancytreeClass.prototype.isEditing=function(){return this.ext.edit.currentNode},i.ui.fancytree._FancytreeNodeClass.prototype.isEditing=function(){return this.tree.ext.edit.currentNode===this},i.ui.fancytree.registerExtension({name:"edit",version:"0.2.0",options:{adjustWidthOfs:4,allowEmpty:!1,inputCss:{minWidth:"3em"},triggerCancel:["esc","tab","click"],triggerStart:["f2","shift+click","mac+enter"],trim:!0,beforeClose:i.noop,beforeEdit:i.noop,close:i.noop,edit:i.noop,save:i.noop},currentNode:null,treeInit:function(b){this._superApply(arguments),this.$container.addClass("fancytree-ext-edit")},nodeClick:function(c){return i.inArray("shift+click",c.options.edit.triggerStart)>=0&&c.originalEvent.shiftKey?(c.node.editStart(),!1):this._superApply(arguments)},nodeDblclick:function(c){return i.inArray("dblclick",c.options.edit.triggerStart)>=0?(c.node.editStart(),!1):this._superApply(arguments)},nodeKeydown:function(c){switch(c.originalEvent.which){case 113:if(i.inArray("f2",c.options.edit.triggerStart)>=0){return c.node.editStart(),!1}break;case i.ui.keyCode.ENTER:if(i.inArray("mac+enter",c.options.edit.triggerStart)>=0&&l){return c.node.editStart(),!1}}return this._superApply(arguments)}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.filter.min.js' */
;!function(j,i,p,o){function n(b){return(b+"").replace(/([.?*+\^\$\[\]\\(){}|-])/g,"\\$1")}function m(c){return c.indexOf(">")>=0?j("<div/>").html(c).text():c}var l="__not_found__",k=j.ui.fancytree.escapeHtml;j.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(A,z,y){var x,w,v,u,t,s=0,h=this.options,g=h.escapeTitles,f=h.filter,e="hide"===f.mode;return y=y||{},x=!!y.leavesOnly&&!z,"string"==typeof A&&(w=f.fuzzy?A.split("").reduce(function(d,c){return d+"[^"+c+"]*"+c}):n(A),u=new RegExp(".*"+w+".*","i"),t=new RegExp(A,"gi"),A=function(r){var q,C=g?r.title:m(r.title),B=!!u.test(C);return B&&f.highlight&&(q=g?k(r.title):C,r.titleWithHighlight=q.replace(t,function(b){return"<mark>"+b+"</mark>"})),B}),this.enableFilter=!0,this.lastFilterArgs=arguments,this.$div.addClass("fancytree-ext-filter"),e?this.$div.addClass("fancytree-ext-filter-hide"):this.$div.addClass("fancytree-ext-filter-dimm"),this.visit(function(b){delete b.match,delete b.titleWithHighlight,b.subMatchCount=0}),v=this.getRootNode()._findDirectChild(l),v&&v.remove(),this.visit(function(b){if(!x||null==b.children){var c=A(b);return"skip"===c?(b.visit(function(d){d.match=!1},!0),"skip"):c&&(s++,b.match=!0,b.visitParents(function(d){d.subMatchCount+=1,y.autoExpand&&!d.expanded&&(d.setExpanded(!0,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),d._filterAutoExpanded=!0)}),z||"branch"===c)?(b.visit(function(d){d.match=!0}),y.autoExpand&&!b.expanded&&(b.setExpanded(!0,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),b._filterAutoExpanded=!0),"skip"):void 0}}),0===s&&f.nodata&&(v=f.nodata,j.isFunction(v)&&(v=v()),v===!0?v={}:"string"==typeof v&&(v={title:v}),v=j.extend({statusNodeType:"nodata",key:l,title:this.options.strings.noData},v),this.getRootNode().addNode(v).match=!0),this.render(),s},j.ui.fancytree._FancytreeClass.prototype.filterNodes=function(d,c){return"boolean"==typeof c&&(c={leavesOnly:c},this.warn("Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19.")),this._applyFilterImpl(d,!1,c)},j.ui.fancytree._FancytreeClass.prototype.applyFilter=function(b){return this.warn("Fancytree.applyFilter() is deprecated since 2.1.0 / 2014-05-29. Use .filterNodes() instead."),this.filterNodes.apply(this,arguments)},j.ui.fancytree._FancytreeClass.prototype.filterBranches=function(d,c){return this._applyFilterImpl(d,!0,c)},j.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){var f,q=this.getRootNode()._findDirectChild(l),h=this.options.escapeTitles,g=this.options.enhanceTitle;q&&q.remove(),this.visit(function(b){b.match&&(f=j(">span.fancytree-title",b.span),h?f.text(b.title):f.html(b.title),g&&g({type:"enhanceTitle"},{node:b,$title:f})),delete b.match,delete b.subMatchCount,delete b.titleWithHighlight,b.$subMatchBadge&&(b.$subMatchBadge.remove(),delete b.$subMatchBadge),b._filterAutoExpanded&&b.expanded&&b.setExpanded(!1,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),delete b._filterAutoExpanded}),this.enableFilter=!1,this.lastFilterArgs=null,this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide"),this.render()},j.ui.fancytree._FancytreeClass.prototype.isFilterActive=function(){return !!this.enableFilter},j.ui.fancytree._FancytreeNodeClass.prototype.isMatched=function(){return !(this.tree.enableFilter&&!this.match)},j.ui.fancytree.registerExtension({name:"filter",version:"0.7.0",options:{autoApply:!0,counter:!0,fuzzy:!1,hideExpandedCounter:!0,highlight:!0,nodata:!0,mode:"dimm",enhanceTitle:null},nodeLoadChildren:function(d,c){return this._superApply(arguments).done(function(){d.tree.enableFilter&&d.tree.lastFilterArgs&&d.options.filter.autoApply&&d.tree._applyFilterImpl.apply(d.tree,d.tree.lastFilterArgs)})},nodeSetExpanded:function(e,d,f){return delete e.node._filterAutoExpanded,!d&&e.options.filter.hideExpandedCounter&&e.node.$subMatchBadge&&e.node.$subMatchBadge.show(),this._superApply(arguments)},nodeRenderStatus:function(y){var x,w=y.node,v=y.tree,u=y.options.filter,t=j("span.fancytree-title",w.span),s=j(w[v.statusClassPropName]),r=y.options.enhanceTitle,q=y.options.escapeTitles;return x=this._superApply(arguments),s.length&&v.enableFilter?(s.toggleClass("fancytree-match",!!w.match).toggleClass("fancytree-submatch",!!w.subMatchCount).toggleClass("fancytree-hide",!(w.match||w.subMatchCount)),!u.counter||!w.subMatchCount||w.isExpanded()&&u.hideExpandedCounter?w.$subMatchBadge&&w.$subMatchBadge.hide():(w.$subMatchBadge||(w.$subMatchBadge=j("<span class='fancytree-childcounter'/>"),j("span.fancytree-icon, span.fancytree-custom-icon",w.span).append(w.$subMatchBadge)),w.$subMatchBadge.show().text(w.subMatchCount)),w.titleWithHighlight?t.html(w.titleWithHighlight):q?t.text(w.title):t.html(w.title),r&&r({type:"enhanceTitle"},{node:w,$title:t}),x):x}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.glyph.min.js' */
;!function(g,f,j,i){function h(d,c){return d.map[c]}g.ui.fancytree.registerExtension({name:"glyph",version:"0.4.0",options:{map:{checkbox:"icon-check-empty",checkboxSelected:"icon-check",checkboxUnknown:"icon-check icon-muted",error:"icon-exclamation-sign",expanderClosed:"icon-caret-right",expanderLazy:"icon-angle-right",expanderOpen:"icon-caret-down",nodata:"icon-meh",noExpander:"",dragHelper:"icon-caret-right",dropMarker:"icon-caret-right",doc:"icon-file-alt",docOpen:"icon-file-alt",loading:"icon-refresh icon-spin",folder:"icon-folder-close-alt",folderOpen:"icon-folder-open-alt"}},treeInit:function(d){var c=d.tree;this._superApply(arguments),c.$container.addClass("fancytree-ext-glyph")},nodeRenderStatus:function(e){var q,p,o,n=e.node,m=g(n.span),l=e.options.glyph,k=l.map;return p=this._superApply(arguments),n.isRoot()?p:(o=m.children("span.fancytree-expander").get(0),o&&(q=n.expanded?"expanderOpen":n.isUndefined()?"expanderLazy":n.hasChildren()?"expanderClosed":"noExpander",o.className="fancytree-expander "+k[q]),o=n.tr?g("td",n.tr).find("span.fancytree-checkbox").get(0):m.children("span.fancytree-checkbox").get(0),o&&(q=n.selected?"checkboxSelected":n.partsel?"checkboxUnknown":"checkbox",o.className="fancytree-checkbox "+k[q]),o=m.children("span.fancytree-icon").get(0),o&&(q=n.statusNodeType?h(l,n.statusNodeType):n.folder?n.expanded?h(l,"folderOpen"):h(l,"folder"):n.expanded?h(l,"docOpen"):h(l,"doc"),o.className="fancytree-icon "+q),p)},nodeSetStatus:function(e,q,p,o){var n,m,l=e.options.glyph,k=e.node;return n=this._superApply(arguments),"error"!==q&&"loading"!==q&&"nodata"!==q||(k.parent?(m=g("span.fancytree-expander",k.span).get(0),m.className="fancytree-expander "+h(l,q)):(m=g(".fancytree-statusnode-"+q,k[this.nodeContainerAttrName]).find("span.fancytree-icon").get(0),m.className="fancytree-icon "+h(l,q))),n}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.gridnav.min.js' */
;!function(r,q,p,o){function n(g,t){var s,i=t.get(0),h=0;return g.children().each(function(){return this===i?!1:(s=r(this).prop("colspan"),void (h+=s?s:1))}),h}function m(g,t){var s,i=null,h=0;return g.children().each(function(){return h>=t?(i=r(this),!1):(s=r(this).prop("colspan"),void (h+=s?s:1))}),i}function l(f,e){var u,t,s=f.closest("td"),h=null;switch(e){case k.LEFT:h=s.prev();break;case k.RIGHT:h=s.next();break;case k.UP:case k.DOWN:for(u=s.parent(),t=n(u,s);;){if(u=e===k.UP?u.prev():u.next(),!u.length){break}if(!u.is(":hidden")&&(h=m(u,t),h&&h.find(":input").length)){break}}}return h}var k=r.ui.keyCode,j={text:[k.UP,k.DOWN],checkbox:[k.UP,k.DOWN,k.LEFT,k.RIGHT],radiobutton:[k.UP,k.DOWN,k.LEFT,k.RIGHT],"select-one":[k.LEFT,k.RIGHT],"select-multiple":[k.LEFT,k.RIGHT]};r.ui.fancytree.registerExtension({name:"gridnav",version:"0.0.1",options:{autofocusInput:!1,handleCursorKeys:!0},treeInit:function(c){this._requireExtension("table",!0,!0),this._superApply(arguments),this.$container.addClass("fancytree-ext-gridnav"),this.$container.on("focusin",function(g){var f,b=r.ui.fancytree.getNode(g.target);b&&!b.isActive()&&(f=c.tree._makeHookContext(b,g),c.tree._callHook("nodeSetActive",f,!0))})},nodeSetActive:function(i,x){var w,v=i.options.gridnav,u=i.node,t=i.originalEvent||{},s=r(t.target).is(":input");x=x!==!1,this._superApply(arguments),x&&(i.options.titlesTabbable?(s||(r(u.span).find("span.fancytree-title").focus(),u.setFocus()),i.tree.$container.attr("tabindex","-1")):v.autofocusInput&&!s&&(w=r(u.tr||u.span),w.find(":input:enabled:first").focus()))},nodeKeydown:function(g){var w,v,u,t=g.options.gridnav,s=g.originalEvent,i=r(s.target);return w=i.is(":input:enabled")?i.prop("type"):null,w&&t.handleCursorKeys?(v=j[w],v&&r.inArray(s.which,v)>=0&&(u=l(i,s.which),u&&u.length)?(u.find(":input:enabled").focus(),!1):!0):this._superApply(arguments)}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.persist.min.js' */
;!function(z,y,x,w){function v(J,I,H,G,F){var E,D,C,B,A=!1,k=[],e=[];for(H=H||[],F=F||z.Deferred(),E=0,C=H.length;C>E;E++){D=H[E],B=J.getNodeByKey(D),B?G&&B.isUndefined()?(A=!0,J.debug("_loadLazyNodes: "+B+" is lazy: loading..."),"expand"===G?k.push(B.setExpanded()):k.push(B.load())):(J.debug("_loadLazyNodes: "+B+" already loaded."),B.setExpanded()):(e.push(D),J.debug("_loadLazyNodes: "+B+" was not yet found."))}return z.when.apply(z,k).always(function(){if(A&&e.length>0){v(J,I,e,G,F)}else{if(e.length){for(J.warn("_loadLazyNodes: could not load those keys: ",e),E=0,C=e.length;C>E;E++){D=H[E],I._appendKey(p,H[E],!1)}}F.resolve()}}),F}var u,t,s,r=z.ui.fancytree.assert,q="active",p="expanded",o="focus",n="selected";"function"==typeof Cookies?(s=Cookies.set,u=Cookies.get,t=Cookies.remove):(s=u=z.cookie,t=z.removeCookie),z.ui.fancytree._FancytreeClass.prototype.clearCookies=function(e){var d=this.ext.persist,f=d.cookiePrefix;e=e||"active expanded focus selected",e.indexOf(q)>=0&&d._data(f+q,null),e.indexOf(p)>=0&&d._data(f+p,null),e.indexOf(o)>=0&&d._data(f+o,null),e.indexOf(n)>=0&&d._data(f+n,null)},z.ui.fancytree._FancytreeClass.prototype.getPersistData=function(){var f=this.ext.persist,e=f.cookiePrefix,h=f.cookieDelimiter,g={};return g[q]=f._data(e+q),g[p]=(f._data(e+p)||"").split(h),g[n]=(f._data(e+n)||"").split(h),g[o]=f._data(e+o),g},z.ui.fancytree.registerExtension({name:"persist",version:"0.3.0",options:{cookieDelimiter:"~",cookiePrefix:w,cookie:{raw:!1,expires:"",path:"",domain:"",secure:!1},expandLazy:!1,fireActivate:!0,overrideSource:!0,store:"auto",types:"active expanded focus selected"},_data:function(e,d){var f=this._local.localStorage;return d===w?f?f.getItem(e):u(e):void (null===d?f?f.removeItem(e):t(e):f?f.setItem(e,d):s(e,d,this.options.persist.cookie))},_appendKey:function(H,G,F){G=""+G;var E=this._local,D=this.options.persist,C=D.cookieDelimiter,B=E.cookiePrefix+H,A=E._data(B),m=A?A.split(C):[],l=z.inArray(G,m);l>=0&&m.splice(l,1),F&&m.push(G),E._data(B,m.join(C))},treeInit:function(i){var d=i.tree,b=i.options,f=this._local,e=this.options.persist;return r("auto"!==e.store&&"cookie"!==e.store||u,"Missing required plugin for 'persist' extension: js.cookie.js or jquery.cookie.js"),f.cookiePrefix=e.cookiePrefix||"fancytree-"+d._id+"-",f.storeActive=e.types.indexOf(q)>=0,f.storeExpanded=e.types.indexOf(p)>=0,f.storeSelected=e.types.indexOf(n)>=0,f.storeFocus=e.types.indexOf(o)>=0,"cookie"!==e.store&&y.localStorage?f.localStorage="local"===e.store?y.localStorage:y.sessionStorage:f.localStorage=null,d.$div.bind("fancytreeinit",function(g){if(d._triggerTreeEvent("beforeRestore",null,{})!==!1){var B,m,h,A,l,k=f._data(f.cookiePrefix+o),j=e.fireActivate===!1;B=f._data(f.cookiePrefix+p),A=B&&B.split(e.cookieDelimiter),m=f.storeExpanded?v(d,f,A,e.expandLazy?"expand":!1,null):(new z.Deferred).resolve(),m.done(function(){if(f.storeSelected){if(B=f._data(f.cookiePrefix+n)){for(A=B.split(e.cookieDelimiter),h=0;h<A.length;h++){l=d.getNodeByKey(A[h]),l?(l.selected===w||e.overrideSource&&l.selected===!1)&&(l.selected=!0,l.renderStatus()):f._appendKey(n,A[h],!1)}}3===d.options.selectMode&&d.visit(function(c){return c.selected?(c.fixSelection3AfterClick(),"skip"):void 0})}f.storeActive&&(B=f._data(f.cookiePrefix+q),!B||!b.persist.overrideSource&&d.activeNode||(l=d.getNodeByKey(B),l&&(l.debug("persist: set active",B),l.setActive(!0,{noFocus:!0,noEvents:j})))),f.storeFocus&&k&&(l=d.getNodeByKey(k),l&&(d.options.titlesTabbable?z(l.span).find(".fancytree-title").focus():z(d.$container).focus())),d._triggerTreeEvent("restore",null,{})})}}),this._superApply(arguments)},nodeSetActive:function(g,f,j){var i,h=this._local;return f=f!==!1,i=this._superApply(arguments),h.storeActive&&h._data(h.cookiePrefix+q,this.activeNode?this.activeNode.key:null),i},nodeSetExpanded:function(h,g,l){var k,j=h.node,i=this._local;return g=g!==!1,k=this._superApply(arguments),i.storeExpanded&&i._appendKey(p,j.key,g),k},nodeSetFocus:function(f,e){var h,g=this._local;return e=e!==!1,h=this._superApply(arguments),g.storeFocus&&g._data(g.cookiePrefix+o,this.focusNode?this.focusNode.key:null),h},nodeSetSelected:function(i,B){var A,m,l=i.tree,k=i.node,j=this._local;return B=B!==!1,A=this._superApply(arguments),j.storeSelected&&(3===l.options.selectMode?(m=z.map(l.getSelectedNodes(!0),function(b){return b.key}),m=m.join(i.options.persist.cookieDelimiter),j._data(j.cookiePrefix+n,m)):j._appendKey(n,k.key,k.selected)),A}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.table.min.js' */
;!function(j,i,p,o){function n(d,e){e=e||"",d||j.error("Assertion failed "+e)}function m(d,c){d.parentNode.insertBefore(c,d.nextSibling)}function l(d,c){d.visit(function(b){var e=b.tr;return e&&(e.style.display=b.hide||!c?"none":""),b.expanded?void 0:"skip"})}function k(e){var u,t,s,r=e.parent,q=r?r.children:null;if(q&&q.length>1&&q[0]!==e){for(u=j.inArray(e,q),s=q[u-1],n(s.tr);s.children&&(t=s.children[s.children.length-1],t.tr);){s=t}}else{s=r}return s}j.ui.fancytree.registerExtension({name:"table",version:"0.3.0",options:{checkboxColumnIdx:null,indentation:16,nodeColumnIdx:0},treeInit:function(w){var v,u,t,s,r=w.tree,q=w.options,e=q.table,c=r.widget.element;if(null!=e.customStatus&&(null!=q.renderStatusColumns?j.error("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' only instead."):(r.warn("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' instead."),q.renderStatusColumns=e.customStatus)),q.renderStatusColumns&&q.renderStatusColumns===!0&&(q.renderStatusColumns=q.renderColumns),c.addClass("fancytree-container fancytree-ext-table"),r.tbody=c.find(">tbody")[0],s=j(r.tbody),r.columnCount=j("thead >tr:last >th",c).length,t=s.children("tr:first"),t.length){u=t.children("td").length,r.columnCount&&u!==r.columnCount&&(r.warn("Column count mismatch between thead ("+r.columnCount+") and tbody ("+u+"); using tbody."),r.columnCount=u),t=t.clone()}else{for(n(r.columnCount>=1,"Need either <thead> or <tbody> with <td> elements to determine column count."),t=j("<tr />"),v=0;v<r.columnCount;v++){t.append("<td />")}}t.find(">td").eq(e.nodeColumnIdx).html("<span class='fancytree-node' />"),q.aria&&(t.attr("role","row"),t.find("td").attr("role","gridcell")),r.rowFragment=p.createDocumentFragment(),r.rowFragment.appendChild(t.get(0)),s.empty(),r.statusClassPropName="tr",r.ariaPropName="tr",this.nodeContainerAttrName="tr",r.$container=c,this._superApply(arguments),j(r.rootNode.ul).remove(),r.rootNode.ul=null,this.$container.attr("tabindex",q.tabindex),q.aria&&r.$container.attr("role","treegrid").attr("aria-readonly",!0)},nodeRemoveChildMarkup:function(d){var e=d.node;e.visit(function(c){c.tr&&(j(c.tr).remove(),c.tr=null)})},nodeRemoveMarkup:function(d){var e=d.node;e.tr&&(j(e.tr).remove(),e.tr=null),this.nodeRemoveChildMarkup(d)},nodeRender:function(E,D,C,B,A){var z,y,x,w,h,g,f,e,I=E.tree,H=E.node,G=E.options,F=!H.parent;if(A||(E.hasCollapsedParents=H.parent&&!H.parent.expanded),!F){if(H.tr){D?this.nodeRenderTitle(E):this.nodeRenderStatus(E)}else{if(E.hasCollapsedParents&&!C){return void H.debug("nodeRender ignored due to unrendered parent")}h=I.rowFragment.firstChild.cloneNode(!0),g=k(H),n(g),B===!0&&A?h.style.display="none":C&&E.hasCollapsedParents&&(h.style.display="none"),g.tr?m(g.tr,h):(n(!g.parent,"prev. row must have a tr, or is system root"),I.tbody.appendChild(h)),H.tr=h,H.key&&G.generateIds&&(H.tr.id=G.idPrefix+H.key),H.tr.ftnode=H,G.aria&&j(H.tr).attr("aria-labelledby","ftal_"+H.key),H.span=j("span.fancytree-node",H.tr).get(0),this.nodeRenderTitle(E),G.createNode&&G.createNode.call(I,{type:"createNode"},E)}}if(G.renderNode&&G.renderNode.call(I,{type:"renderNode"},E),z=H.children,z&&(F||C||H.expanded)){for(x=0,w=z.length;w>x;x++){e=j.extend({},E,{node:z[x]}),e.hasCollapsedParents=e.hasCollapsedParents||!H.expanded,this.nodeRender(e,D,C,B,!0)}}z&&!A&&(f=H.tr||null,y=I.tbody.firstChild,H.visit(function(d){if(d.tr){if(d.parent.expanded||"none"===d.tr.style.display||(d.tr.style.display="none",l(d,!1)),d.tr.previousSibling!==f){H.debug("_fixOrder: mismatch at node: "+d);var c=f?f.nextSibling:y;I.tbody.insertBefore(d.tr,c)}f=d.tr}}))},nodeRenderTitle:function(q,w){var v,u,t=q.node,s=q.options,r=t.isStatusNode();return u=this._superApply(arguments),t.isRootNode()?u:(s.checkbox&&!r&&null!=s.table.checkboxColumnIdx&&(v=j("span.fancytree-checkbox",t.span),j(t.tr).find("td").eq(+s.table.checkboxColumnIdx).html(v)),this.nodeRenderStatus(q),r?s.renderStatusColumns&&s.renderStatusColumns.call(q.tree,{type:"renderStatusColumns"},q):s.renderColumns&&s.renderColumns.call(q.tree,{type:"renderColumns"},q),u)},nodeRenderStatus:function(f){var q,h=f.node,g=f.options;this._superApply(arguments),j(h.tr).removeClass("fancytree-node"),q=(h.getLevel()-1)*g.table.indentation,j(h.span).css({paddingLeft:q+"px"})},nodeSetExpanded:function(g,u,t){function s(b){l(g.node,u),b?u&&g.options.autoScroll&&!t.noAnimation&&g.node.hasChildren()?g.node.getLastChild().scrollIntoView(!0,{topNode:g.node}).always(function(){t.noEvents||g.tree._triggerNodeEvent(u?"expand":"collapse",g),r.resolveWith(g.node)}):(t.noEvents||g.tree._triggerNodeEvent(u?"expand":"collapse",g),r.resolveWith(g.node)):(t.noEvents||g.tree._triggerNodeEvent(u?"expand":"collapse",g),r.rejectWith(g.node))}if(u=u!==!1,g.node.expanded&&u||!g.node.expanded&&!u){return this._superApply(arguments)}var r=new j.Deferred,q=j.extend({},t,{noEvents:!0,noAnimation:!0});return t=t||{},this._super(g,u,q).done(function(){s(!0)}).fail(function(){s(!1)}),r.promise()},nodeSetStatus:function(h,u,t,s){if("ok"===u){var r=h.node,q=r.children?r.children[0]:null;q&&q.isStatusNode()&&j(q.tr).remove()}return this._superApply(arguments)},treeClear:function(b){return this.nodeRemoveChildMarkup(this._makeHookContext(this.rootNode)),this._superApply(arguments)},treeDestroy:function(b){this.$container.find("tbody").empty(),this.$source&&this.$source.removeClass("ui-helper-hidden")}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.themeroller.min.js' */
;!function(f,e,h,g){f.ui.fancytree.registerExtension({name:"themeroller",version:"0.0.1",options:{activeClass:"ui-state-active",foccusClass:"ui-state-focus",hoverClass:"ui-state-hover",selectedClass:"ui-state-highlight"},treeInit:function(d){this._superApply(arguments);var i=d.widget.element;"TABLE"===i[0].nodeName?(i.addClass("ui-widget ui-corner-all"),i.find(">thead tr").addClass("ui-widget-header"),i.find(">tbody").addClass("ui-widget-conent")):i.addClass("ui-widget ui-widget-content ui-corner-all"),i.delegate(".fancytree-node","mouseenter mouseleave",function(j){var l=f.ui.fancytree.getNode(j.target),k="mouseenter"===j.type;l.debug("hover: "+k),f(l.tr?l.tr:l.span).toggleClass("ui-state-hover ui-corner-all",k)})},treeDestroy:function(b){this._superApply(arguments),b.widget.element.removeClass("ui-widget ui-widget-content ui-corner-all")},nodeRenderStatus:function(i){var k=i.node,j=f(k.tr?k.tr:k.span);this._superApply(arguments),j.toggleClass("ui-state-active",k.isActive()),j.toggleClass("ui-state-focus",k.hasFocus()),j.toggleClass("ui-state-highlight",k.isSelected())}})}(jQuery,window,document);
/*! Extension 'jquery.fancytree.wide.min.js' */
;!function(i,h,n,m){function l(f,p){f="fancytree-style-"+f;var o=i("#"+f);if(!p){return o.remove(),null}o.length||(o=i("<style />").attr("id",f).addClass("fancytree-style").prop("type","text/css").appendTo("home-header-part.php.php"));try{o.html(p)}catch(g){o[0].styleSheet.cssText=p}return o}function k(p,o,v,u,t){var s,r="#"+p+" span.fancytree-level-",q=[];for(s=0;o>s;s++){q.push(r+(s+1)+" span.fancytree-title { padding-left: "+(s*v+u)+t+"; }")}return q.push("#"+p+" div.ui-effects-wrapper ul li span.fancytree-title { padding-left: 3px; position: static; width: auto; }"),q.join("\n")}var j=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;i.ui.fancytree.registerExtension({name:"wide",version:"0.0.3",options:{iconWidth:null,iconSpacing:null,levelOfs:null},treeCreate:function(A){this._superApply(arguments),this.$container.addClass("fancytree-ext-wide");var z,y,x,w,v,u=A.options.wide,t=i("<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /></span><ul />").appendTo(A.tree.$container),s=t.find(".fancytree-icon"),r=t.find("ul"),g=u.iconSpacing||s.css("margin-left"),f=u.iconWidth||s.css("width"),e=u.levelOfs||r.css("padding-left");t.remove(),x=g.match(j)[2],g=parseFloat(g,10),w=f.match(j)[2],f=parseFloat(f,10),v=e.match(j)[2],x===w&&v===w||i.error("iconWidth, iconSpacing, and levelOfs must have the same css measure unit"),this._local.measureUnit=w,this._local.levelOfs=parseFloat(e),this._local.lineOfs=(1+(A.options.checkbox?1:0)+(A.options.icon===!1?0:1))*(f+g)+g,this._local.maxDepth=10,z=this.$container.uniqueId().attr("id"),y=k(z,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit),l(z,y)},treeDestroy:function(b){return l(this.$container.attr("id"),null),this._superApply(arguments)},nodeRenderStatus:function(e){var r,q,p,o=e.node,f=o.getLevel();return p=this._superApply(arguments),f>this._local.maxDepth&&(r=this.$container.attr("id"),this._local.maxDepth*=2,o.debug("Define global ext-wide css up to level "+this._local.maxDepth),q=k(r,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit),l(r,q)),i(o.span).addClass("fancytree-level-"+f),p}})}(jQuery,window,document)}));